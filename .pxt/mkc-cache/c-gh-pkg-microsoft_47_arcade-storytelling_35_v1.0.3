{"files":{"pxt.json":"{\n    \"name\": \"arcade-story\",\n    \"version\": \"1.0.3\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"main.ts\",\n        \"README.md\",\n        \"api.ts\",\n        \"message.ts\",\n        \"script.ts\",\n        \"sequence.ts\",\n        \"move.ts\",\n        \"scene.ts\",\n        \"text.ts\",\n        \"dialog.ts\",\n        \"shapeSprites.ts\",\n        \"menu.ts\",\n        \"menuState.ts\",\n        \"cancel-current-text.md\",\n        \"cancel-cutscene.md\",\n        \"last-answer-equals.md\",\n        \"print-character-text.md\",\n        \"print-dialog.md\",\n        \"print-text.md\",\n        \"set-page-pause-length.md\",\n        \"show-player-choices.md\",\n        \"sprite-cancel-movement.md\",\n        \"sprite-move-to-position.md\",\n        \"sprite-move-to-tilemap-location.md\",\n        \"sprite-say.md\",\n        \"start-cutscene.md\",\n        \"set-sound-enabled.md\",\n        \"cancel-all-cutscenes.md\",\n        \"get-last-answer.md\",\n        \"is-menu-open.md\"\n    ],\n    \"testFiles\": [\n        \"test.ts\"\n    ],\n    \"targetVersions\": {\n        \"target\": \"1.3.44\",\n        \"targetId\": \"arcade\"\n    },\n    \"supportedTargets\": [\n        \"arcade\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n","main.ts":"\n","README.md":"# Arcade story extension\n\nAn extension with useful blocks for creating cutscenes and stories in MakeCode Arcade.\n\n#### Metadata (used for search, rendering)\n\n* for PXT/arcade\n\n# Contributing\n\nThis project welcomes contributions and suggestions.  Most contributions require you to agree to a\nContributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us\nthe rights to use your contribution. For details, visit https://cla.opensource.microsoft.com.\n\nWhen you submit a pull request, a CLA bot will automatically determine whether you need to provide\na CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions\nprovided by the bot. You will only need to do this once across all repos using our CLA.\n\nThis project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).\nFor more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or\ncontact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.\n","api.ts":"//% block=\"Story\" color=\"#b36634\" icon=\"\\uf02d\"\n//% groups='[\"Text\",\"Movement\",\"Cutscene\",\"Menu\"]'\nnamespace story {\n    export interface Task {\n        isDone(): boolean;\n        key?: string;\n        cancel?: () => void;\n    }\n}","message.ts":"namespace story {\n    export class MessagePart {\n        public readonly text: string;\n        public readonly charsPerSecond: number;\n        public readonly width: number;\n        public readonly height: number;\n\n        constructor(text: string, charsPerSecond: number) {\n            this.text = text;\n            this.charsPerSecond = charsPerSecond;\n\n            const f = image.getFontForText(text);\n            this.width = f.charWidth * text.length;\n            this.height = f.charHeight;\n        }\n\n        substring(length: number) {\n            return new MessagePart(this.text.substr(0, length), this.charsPerSecond);\n        }\n    }\n\n    const maxPanDistance = 30;\n\n    export class MessageLine {\n        public readonly parts: MessagePart[];\n        public readonly width: number;\n        public readonly height: number;\n\n        constructor(parts: MessagePart[]) {\n            this.parts = parts;\n            this.width = 0;\n            this.height = 0;\n\n            for (const p of parts) {\n                this.width += p.width;\n                this.height = Math.max(this.height, p.height);\n            }\n        }\n\n        get text() {\n            return this.parts.map(p => p.text).join(\"\");\n        }\n    }\n\n    export class MessagePage {\n        public readonly lines: MessageLine[];\n\n        constructor(lines: MessageLine[]) {\n            this.lines = lines;\n        }\n    }\n\n    const tickSound = new music.Melody(\"@20,10,0,0 c5:1-150\")\n\n    enum BubbleState {\n        Printing,\n        Stopped,\n        Paused\n    }\n\n    export class Bubble extends sprites.BaseSprite implements Task {\n        protected anchor: Sprite;\n        protected cx: number;\n        protected cy: number;\n\n        public pagePauseLength = 1000;\n        public finalPagePauseLength = 1000;\n        public foregroundColor = 15;\n        public backgroundColor = 1;\n\n        protected timer: number;\n        protected tickPeriod: number;\n\n        protected pageIndex: number;\n        protected lineIndex: number;\n        protected partIndex: number;\n        protected tick: number;\n\n        protected pages: MessagePage[];\n\n        protected endCB: () => void;\n        protected padding: number;\n\n        protected state: BubbleState;\n\n        protected centered: boolean;\n        protected leftAlign: number;\n        protected topAlign: number;\n\n        constructor(z = 1, protected relativeToCamera = false) {\n            super(z);\n\n            this.cx = 0;\n            this.cy = 0;\n\n            this.pageIndex = 0;\n            this.lineIndex = 0;\n            this.partIndex = 0;\n            this.tick = 0;\n\n            this.padding = 2;\n\n            this.state = BubbleState.Stopped;\n\n            this.pages = [];\n        }\n\n        isPrinting() {\n            return this.state !== BubbleState.Stopped && this.state !== BubbleState.Paused;\n        }\n\n        isDone() {\n            return this.state === BubbleState.Stopped;\n        }\n\n        cancel() {\n            this.destroy();\n        }\n\n        setAlign(left: number, top: number) {\n            this.leftAlign = left;\n            this.topAlign = top;\n        }\n\n        __drawCore(camera: scene.Camera) {\n            const page = this.currentPage;\n            if (!page) return;\n\n            const lines = page.lines.slice(0, this.lineIndex);\n            if (this.currentLine) lines.push(getPartialLine(this.currentLine, this.partIndex, this.tick));\n\n            // A small min width looks better\n            let width = 20;\n            let height = 0;\n\n            let i: number;\n            for (i = 0; i < lines.length; i++) {\n                height += lines[i].height;\n                width = Math.max(width, lines[i].width);\n            }\n\n            height += this.padding << 1\n            width += this.padding << 1\n\n            let left: number ;\n            let top: number;\n\n            if (this.leftAlign) {\n                left = this.leftAlign + this.padding;\n            }\n            else {\n                left = this.cx - (width >> 1) - (this.relativeToCamera ? 0 : camera.drawOffsetX)\n\n                if (left + width > screen.width) {\n                    if (left + width - screen.width > maxPanDistance) {\n                        left -= maxPanDistance\n                    }\n                    else {\n                        left = screen.width - width;\n                    }\n                }\n                else if (left < 0) {\n                    if (left < -maxPanDistance) {\n                        left += maxPanDistance;\n                    }\n                    else {\n                        left = 0\n                    }\n                }\n            }\n\n            if (this.topAlign) {\n                top = this.topAlign + this.padding;\n            }\n            else {\n                top = this.cy - (height >> 1) - (this.relativeToCamera ? 0 : camera.drawOffsetY)\n\n                if (lines.length > 1) {\n                    for (i = 0; i < lines.length - 1; i++) {\n                        top -= lines[i].height >> 1;\n                    }\n                }\n\n                if (top + height > screen.height) {\n                    if (top + height - screen.height > maxPanDistance) {\n                        top -= maxPanDistance;\n                    }\n                    else {\n                        top = screen.height - height;\n                    }\n                }\n                else if (top < 0) {\n                    if (top < -maxPanDistance) {\n                        top += maxPanDistance\n                    }\n                    else {\n                        top = 0\n                    }\n                }\n            }\n\n            if (top > screen.height || top + height < 0 || left > screen.width || left + width < 0) {\n                return;\n            }\n\n            if (this.backgroundColor) {\n                screen.fillRect(left, top, width, height, this.backgroundColor);\n            }\n\n            top += this.padding\n\n            for (i = 0; i < lines.length; i++) {\n                this.drawLine(left + (this.centered ? ((width >> 1) - (lines[i].width >> 1)) : this.padding), top, lines[i]);\n                top += lines[i].height;\n            }\n        }\n\n        protected get currentPage() {\n            return this.pages[this.pageIndex];\n        }\n\n        protected get currentLine() {\n            return this.currentPage && this.currentPage.lines[this.lineIndex];\n        }\n\n        protected get currentPart() {\n            return this.currentLine && this.currentLine.parts[this.partIndex];\n        }\n\n        startMessage(pages: MessagePage[], onEnd?: () => void) {\n            this.pages = pages;\n            this.endCB = onEnd;\n            this.state = BubbleState.Printing;\n\n            this.pageIndex = 0;\n            this.lineIndex = 0;\n            this.tick = 0;\n\n            this.partIndex = -1;\n            this.advancePart();\n            this.timer = this.tickPeriod;\n        }\n\n        setAnchor(cx: number, cy: number) {\n            this.cx = cx;\n            this.cy = cy;\n        }\n\n        setAnchorSprite(anchor: Sprite) {\n            this.anchor = anchor;\n\n            if (this.anchor) {\n                this.setAnchor(this.anchor.x, this.anchor.top - 8);\n            }\n        }\n\n        setCentered(enabled: boolean) {\n            this.centered = enabled;\n        }\n\n        __update(camera: scene.Camera, dt: number) {\n            this.updateCore(game.currentScene().eventContext.deltaTimeMillis);\n        }\n\n        stop() {\n            this.state = BubbleState.Stopped;\n        }\n\n        destroy() {\n            game.currentScene().allSprites.removeElement(this);\n            this.stop();\n        }\n\n        protected updateCore(dtMillis: number) {\n            if (this.state === BubbleState.Stopped) return;\n\n            if (this.anchor) {\n                this.setAnchor(this.anchor.x, this.anchor.top - 8);\n            }\n\n            this.timer -= dtMillis;\n\n            while (this.timer < 0) {\n                if (this.state === BubbleState.Paused) {\n                    this.advancePage();\n                    this.timer = this.tickPeriod;\n                }\n                else {\n                    this.tick++;\n                    this.timer += this.tickPeriod;\n                    playWithVolume(tickSound, 60)\n\n                    if (this.tick >= this.currentPart.text.length) {\n                        this.advancePart();\n                    }\n                }\n\n                if ((this.state as BubbleState) === BubbleState.Stopped) return;\n            }\n        }\n\n        protected setRate(charsPerSecond: number) {\n            this.tickPeriod = (1000 / charsPerSecond) | 0;\n        }\n\n        protected advancePart() {\n            this.tick = 0;\n            this.partIndex++;\n\n            if (this.currentPart) {\n                this.setRate(this.currentPart.charsPerSecond);\n            }\n            else {\n                this.advanceLine();\n            }\n        }\n\n        protected advanceLine() {\n            this.lineIndex++;\n\n            if (this.currentLine) {\n                this.partIndex = -1;\n                this.advancePart();\n            }\n            else {\n                this.state = BubbleState.Paused;\n                if (this.pageIndex == this.pages.length - 1) {\n                    this.timer += this.finalPagePauseLength\n                }\n                else {\n                    this.timer += this.pagePauseLength;\n                }\n            }\n        }\n\n        protected advancePage() {\n            this.pageIndex++;\n            this.state = BubbleState.Printing;\n\n            if (this.currentPage) {\n                this.lineIndex = -1;\n                this.advanceLine();\n            }\n            else {\n                this.state = BubbleState.Stopped;\n                if (this.endCB) this.endCB();\n            }\n        }\n\n        protected drawPart(left: number, top: number, part: MessagePart, length?: number) {\n            const text = length ? part.text.substr(0, length) : part.text;\n            screen.print(text, left, top, this.foregroundColor)\n        }\n\n        protected drawLine(left: number, top: number, line: MessageLine) {\n            for (const p of line.parts) {\n                this.drawPart(left, top, p);\n                left += p.width;\n            }\n        }\n    }\n\n    function getPartialLine(line: MessageLine, partIndex: number, tick: number) {\n        const parts = line.parts.slice(0, partIndex);\n        parts.push(line.parts[partIndex].substring(tick));\n        return new MessageLine(parts);\n    }\n\n    function playWithVolume(sound: music.Melody, volume: number) {\n        if (!_currentCutscene().soundEnabled) return;\n        sound.play(volume);\n    }\n\n    export function line(text: string, speed: TextSpeed): MessageLine {\n        return new MessageLine([new MessagePart(text, speed)]);\n    }\n\n    export function page(line1: MessageLine, line2?: MessageLine, line3?: MessageLine, line4?: MessageLine, line5?: MessageLine) {\n        return new MessagePage([line1, line2, line3, line4, line5].filter(l => !!l));\n    }\n\n    export function say(sprite: Sprite, page: MessagePage) {\n        sayPages(sprite, [page]);\n    }\n\n    export function sayPages(sprite: Sprite, pages: MessagePage[]) {\n        const b = new Bubble();\n        b.setAnchorSprite(sprite);\n        b.startMessage(pages);\n    }\n}","script.ts":"namespace story {\n    export enum TextSpeed {\n        //% block=\"very slow\"\n        VerySlow = 4,\n        //% block=\"slow\"\n        Slow = 8,\n        //% block=\"normal\"\n        Normal = 12,\n        //% block=\"fast\"\n        Fast = 16,\n        //% block=\"very fast\"\n        VeryFast = 20\n    }\n\n    export let _defaultPagePauseLength = 1000;\n    export let _defaultFinalPagePauseLength = 1000;\n\n    export class Script {\n        pages: MessagePage[];\n        foregroundColor: number;\n        backgroundColor: number;\n        pagePauseMillis: number;\n        finalPagePauseLength: number;\n        relativeToCamera: boolean;\n\n        constructor(pages?: MessagePage[]) {\n            this.pages = pages || [];\n            this.foregroundColor = 0xf;\n            this.backgroundColor = 0x1;\n            this.pagePauseMillis = _defaultPagePauseLength;\n            this.finalPagePauseLength = _defaultFinalPagePauseLength;\n            this.relativeToCamera = false;\n        }\n\n        //% blockId=script_add_line\n        //% block=\"$this(script) add line $text $speed\"\n        //% weight=90\n        //% blockGap=8\n        //% group=\"Script\"\n        //% deprecated=1\n        addLineToCurrentPage(text: string, speed: TextSpeed) {\n            if (!this.pages.length) {\n                this.pages.push(new MessagePage([]));\n            }\n            this.pages[this.pages.length - 1].lines.push(line(text, speed));\n        }\n\n        //% blockId=script_new_page\n        //% block=\"$this(script) start new page\"\n        //% weight=80\n        //% blockGap=8\n        //% group=\"Script\"\n        //% deprecated=1\n        newPage() {\n            this.pages.push(new MessagePage([]));\n        }\n\n        //% blockId=script_set_colors\n        //% block=\"$this(script) set text color $foreground background color $background\"\n        //% foreground.shadow=colorindexpicker\n        //% foreground.defl=15\n        //% background.shadow=colorindexpicker\n        //% background.defl=1\n        //% weight=70\n        //% blockGap=8\n        //% group=\"Script\"\n        //% deprecated=1\n        setColors(foreground: number, background: number) {\n            this.foregroundColor = foreground;\n            this.backgroundColor = background;\n        }\n\n        //% blockId=script_set_pause_length\n        //% block=\"$this(script) pause for $pauseMillis ms at end of page\"\n        //% pauseMillis.shadow=timePicker\n        //% pauseMillis.defl=1000\n        //% weight=60\n        //% group=\"Script\"\n        //% deprecated=1\n        setPagePauseLength(pauseMillis: number) {\n            this.pagePauseMillis = pauseMillis;\n        }\n\n        //% blockId=script_set_relative_to_camera\n        //% block=\"$this(script) set relative to camera $relativeToCamera\"\n        //% weight=5\n        //% blockGap=8\n        //% group=\"Script\"\n        //% deprecated=1\n        setRelativeToCamera(relativeToCamera: boolean) {\n            this.relativeToCamera = relativeToCamera;\n        }\n    }\n\n    //% blockId=story_create_script\n    //% block=\"create empty script\"\n    //% blockSetVariable=script\n    //% weight=98\n    //% group=\"Script\"\n    //% deprecated=1\n    export function createEmptyScript(): Script {\n        const script = new Script();\n        return script;\n    }\n\n    \n    //% blockId=story_create_script_arguments\n    //% block=\"create script $text with text color $foreground back color $background\"\n    //% text.defl=\":)\"\n    //% foreground.shadow=colorindexpicker\n    //% foreground.defl=15\n    //% background.shadow=colorindexpicker\n    //% background.defl=1\n    //% blockSetVariable=script\n    //% weight=99\n    //% group=\"Script\"\n    //% deprecated=1\n    export function createScript(text: string, foreground: number, background: number): Script {\n        const script = new Script();\n        \n        if (text) {\n            script.addLineToCurrentPage(text, TextSpeed.Normal);\n        }\n\n        script.setColors(foreground, background);\n        return script;\n    }\n\n    //% blockId=story_print_script\n    //% block=\"print $script at x $x y $y z $z\"\n    //% script.shadow=variables_get\n    //% script.defl=script\n    //% x.defl=80\n    //% y.defl=60\n    //% weight=50\n    //% inlineInputMode=inline\n    //% blockGap=8\n    //% group=\"Script\"\n    //% deprecated=1\n    export function printScript(script: Script, x: number, y: number, z: number, align = false, relativeToCamera = false) {\n        const b = new Bubble(z, relativeToCamera || script.relativeToCamera);\n\n        if (align) {\n            b.setAlign(x, y);\n        }\n        else {\n            b.setAnchor(x, y);\n        }\n\n        startScript(script, b);\n    }\n\n    //% blockId=story_sprite_say_script\n    //% block=\"$sprite say $script\"\n    //% sprite.shadow=variables_get\n    //% sprite.defl=sprite\n    //% script.shadow=variables_get\n    //% script.defl=script\n    //% weight=40\n    //% group=\"Script\"\n    //% deprecated=1\n    export function spriteSayScript(sprite: Sprite, script: Script) {\n        const b = new Bubble();\n        b.setAnchorSprite(sprite);\n        b.z = sprite.z;\n\n        startScript(script, b);\n    }\n\n    function startScript(script: Script, bubble: Bubble) {\n        bubble.foregroundColor = script.foregroundColor;\n        bubble.backgroundColor = script.backgroundColor;\n        bubble.pagePauseLength = script.pagePauseMillis;\n        bubble.finalPagePauseLength = script.finalPagePauseLength;\n        bubble.startMessage(script.pages);\n\n        _trackTask(bubble);\n        if (!_isInQueueStoryPart()) {\n            _currentCutscene().currentTask = bubble;\n            _pauseUntilTaskIsComplete(bubble);\n        }\n    }\n}","sequence.ts":"namespace story {\n    let stateStack: StoryState[];\n    export class StoryState {\n        queue: (() => void)[];\n        running: boolean;\n        lock: boolean;\n        protected activeTasks: Task[];\n\n        constructor() {\n            this.activeTasks = [];\n            this.queue = [];\n            this.running = false;\n        }\n\n        trackTask(task: Task) {\n            this.activeTasks.push(task);\n        }\n\n        reset() {\n            this.activeTasks = [];\n            this.running = false;\n        }\n\n        shouldAdvance() {\n            return !this.activeTasks.some(task => !task.isDone());\n        }\n\n        cancelByKey(key: string) {\n            for (const task of this.activeTasks) {\n                if (task.key === key && task.cancel && !task.isDone()) {\n                    task.cancel();\n                    return;\n                }\n            }\n        }\n\n        clear() {\n            this.queue = [];\n            for (const task of this.activeTasks) {\n                if (task.cancel && !task.isDone())\n                    task.cancel();\n            }\n            this.reset();\n        }\n\n        clearFinishedTasks() {\n            if (this.activeTasks.some(task => task.isDone())) {\n                this.activeTasks = this.activeTasks.filter(task => !task.isDone());\n            }\n        }\n    }\n\n    //% blockId=story_queue_story_part\n    //% block=\"queue story part\"\n    //% group=\"Sequence\"\n    //% handlerStatement=1\n    //% deprecated=1\n    export function queueStoryPart(cb: () => void) {\n        init();\n        stateStack[stateStack.length - 1].queue.push(cb);\n    }\n\n    //% blockId=story_clear_story_parts\n    //% block=\"clear queued story parts\"\n    //% group=\"Scene\"\n    //% deprecated=1\n    export function clearQueuedStoryParts() {\n        init();\n        stateStack[stateStack.length - 1].clear();\n    }\n\n    export function _trackTask(task: Task) {\n        init();\n        const state = stateStack && stateStack[stateStack.length - 1];\n        if (state) {\n            state.trackTask(task);\n        }\n    }\n\n    export function _cancelTask(key: string) {\n        const state = stateStack && stateStack[stateStack.length - 1];\n        if (state) {\n            state.cancelByKey(key);\n        }\n    }\n\n    export function _isInQueueStoryPart() {\n        if (stateStack && stateStack.length) {\n            const state = stateStack[stateStack.length - 1]\n            return state.lock;\n        }\n        return false;\n    }\n\n    function init() {\n        if (stateStack) return;\n\n        stateStack = [new StoryState()];\n\n        let lock = false;\n\n        game.addScenePushHandler(function () {\n            stateStack.push(new StoryState());\n        });\n\n        game.addScenePopHandler(function() {\n            stateStack.pop();\n\n            if (stateStack.length === 0) {\n                stateStack.push(new StoryState());\n            }\n        });\n\n        game.onUpdate(function() {\n            const state = stateStack[stateStack.length - 1];\n            state.clearFinishedTasks();\n            if (state.lock) return;\n\n            if (state.queue.length) {\n                if (state.shouldAdvance() || !state.running) {\n                    if (state.running) {\n                        state.queue.shift();\n                        state.reset();\n                    }\n\n                    if (state.queue.length) {\n                        state.running = true;\n                        control.runInParallel(function () {\n                            state.lock = true;\n                            state.queue[0]();\n                            state.lock = false;\n                        });\n                    }\n                }\n            }\n        });\n    }\n}","move.ts":"namespace story {\n    /**\n     * Moves a sprite directly to a specific x y position and pauses until the move is complete.\n     * If there are walls blocking the sprite, it will attempt to move and then teleport\n     * to its final destination.\n     *\n     * A sprite can only have one movement operation active at a time, so calling this on a sprite\n     * that is already moving will cancel the other task.\n     *\n     * @param sprite The sprite to move\n     * @param x The absolute x position for the sprite to move to\n     * @param y The absolute y position for the sprite to move ot\n     * @param speed The speed at which the sprite should move\n     */\n    //% blockId=story_sprite_move_to_location\n    //% block=\"$sprite move to x $x y $y with speed $speed\"\n    //% help=github:arcade-story/sprite-move-to-position.md\n    //% inlineInputMode=inline\n    //% sprite.shadow=variables_get\n    //% sprite.defl=sprite\n    //% speed.defl=100\n    //% blockGap=8\n    //% group=\"Movement\"\n    //% weight=80\n    export function spriteMoveToLocation(sprite: Sprite, x: number, y: number, speed: number) {\n        const distance = calculateDistance(sprite, x, y);\n        const time = (distance / speed) * 1000;\n        const angle = Math.atan2(y - sprite.y, x - sprite.x);\n\n        sprite.ax = 0;\n        sprite.ay = 0;\n        sprite.vx = Math.cos(angle) * speed;\n        sprite.vy = Math.sin(angle) * speed;\n\n        const key = moveTaskKey(sprite);\n        _cancelTask(key);\n\n        let done = false;\n        let ref = setTimeout(function () {\n            sprite.vx = 0;\n            sprite.vy = 0;\n            sprite.x = x;\n            sprite.y = y;\n            done = true;\n        }, time);\n\n        let task: Task = {\n            key: key,\n            isDone: () => done,\n            cancel: () => {\n                done = true;\n                sprite.vx = 0;\n                sprite.vy = 0;\n                clearTimeout(ref);\n            }\n        };\n\n        _trackTask(task);\n        if (!_isInQueueStoryPart()) {\n            _currentCutscene().currentTask = task;\n            _pauseUntilTaskIsComplete(task);\n        }\n    }\n\n    /**\n     * Cancels any currently active movement operations on a sprite.\n     *\n     * @param sprite The sprite to cancel movement on\n     */\n    //% blockId=story_sprite_cancel_movement\n    //% block=\"$sprite cancel movement\"\n    //% help=github:arcade-story/sprite-cancel-movement.md\n    //% inlineInputMode=inline\n    //% sprite.shadow=variables_get\n    //% sprite.defl=sprite\n    //% blockGap=8\n    //% group=\"Movement\"\n    //% weight=70\n    export function cancelSpriteMovement(sprite: Sprite) {\n        const key = moveTaskKey(sprite);\n        _cancelTask(key);\n    }\n\n    function calculateDistance(sprite: Sprite, x: number, y: number) {\n        return Math.sqrt(Math.pow(sprite.x - x, 2) + Math.pow(sprite.y - y, 2));\n    }\n\n    function moveTaskKey(sprite: Sprite) {\n        return \"move_\" + sprite.id;\n    }\n\n    // Commented out because the A-Star extension isn't approved\n    // /**\n    //  * Moves a sprite to a specified location in the tilemap using pathfinding and pauses until the\n    //  * movement is complete. If no path is possible, this block will cause an exception.\n    //  *\n    //  * A sprite can only have one movement operation active at a time, so calling this on a sprite\n    //  * that is already moving will cancel the other task.\n    //  *\n    //  * @param sprite The sprite to move\n    //  * @param location The tilemap location to move to\n    //  * @param speed The speed at which the sprite should move\n    //  */\n    // //% blockId=story_sprite_move_to_tile\n    // //% block=\"$sprite move to $location with speed $speed\"\n    // //% help=github:arcade-story/sprite-move-to-tilemap-location.md\n    // //% sprite.shadow=variables_get\n    // //% sprite.defl=sprite\n    // //% location.shadow=mapgettile\n    // //% speed.defl=100\n    // //% blockGap=8\n    // //% group=\"Movement\"\n    // //% weight=100\n    // export function spriteMoveToTile(sprite: Sprite, location: tiles.Location, speed: number) {\n    //     const start = tiles.getTileLocation(sprite.x >> game.currentScene().tileMap.scale, sprite.y >> game.currentScene().tileMap.scale)\n    //     const key = moveTaskKey(sprite);\n    //     _cancelTask(key);\n    //     if (start) {\n    //         let done = false;\n    //         let task = {\n    //             key: key,\n    //             isDone: () => done,\n    //             cancel: () => {\n    //                 done = true;\n    //                 scene._followPath(sprite, null);\n    //             }\n    //         };\n    //         const path = scene.aStar(start, location);\n    //         scene._followPath(sprite, path, speed, () => {\n    //             done = true;\n    //         });\n\n    //         _trackTask(task);\n    //         if (!_isInQueueStoryPart()) {\n    //             _currentCutscene().currentTask = task;\n    //             _pauseUntilTaskIsComplete(task);\n    //         }\n    //     }\n    //     else if (location) {\n    //         spriteMoveToLocation(sprite, location.x, location.y, speed);\n    //     }\n    // }\n}","scene.ts":"namespace story {\n    //% blockId=story_push_scene\n    //% block=\"push scene\"\n    //% blockGap=8\n    //% group=\"Scene\"\n    //% deprecated=1\n    export function pushScene() {\n        game.pushScene();\n    }\n\n    //% blockId=story_pop_scene\n    //% block=\"pop scene\"\n    //% blockGap=8\n    //% group=\"Scene\"\n    //% deprecated=1\n    export function popScene() {\n        game.popScene();\n    }\n\n    //% blockId=story_clear_scene\n    //% block=\"clear scene\"\n    //% blockGap=8\n    //% group=\"Scene\"\n    //% deprecated=1\n    export function clearScene() {\n        popScene();\n        pushScene();\n    }\n\n    /**\n     * Cancels all text from the story extension that is currently visible on the screen.\n     */\n    //% blockId=\"story_clear_all_text\"\n    //% block=\"cancel current text\"\n    //% help=github:arcade-story/cancel-current-text.md\n    //% group=\"Cutscene\"\n    //% blockGap=8\n    //% weight=20\n    export function clearAllText() {\n        for (const bubble of getAllBubbles()) {\n            bubble.destroy();\n        }\n    }\n\n    export function getAllBubbles() {\n        const all: Bubble[] = [];\n\n        for (const sprite of game.currentScene().allSprites) {\n            if (sprite instanceof Bubble) {\n                all.push(sprite);\n            }\n        }\n\n        return all;\n    }\n}","text.ts":"namespace story {\n    export const TEXT_Z = scene.HUD_Z - 1;\n\n    /**\n     * Prints some text to the screen one character at a time.\n     *\n     * @param text The text to print to the screen\n     * @param x The center x position to print the text at\n     * @param y The center y position to print the text at\n     * @param foreground The color used to print the text\n     * @param background The color of the background behind the printed text\n     * @param speed The speed at which to print the text\n     */\n    //% blockId=story_show_text\n    //% block=\"print $text at x $x y $y||with text color $foreground back color $background $speed\"\n    //% help=github:arcade-story/print-text.md\n    //% text.defl=\":)\"\n    //% foreground.shadow=colorindexpicker\n    //% foreground.defl=15\n    //% background.shadow=colorindexpicker\n    //% background.defl=1\n    //% inlineInputMode=inline\n    //% blockGap=8\n    //% weight=99\n    //% group=\"Text\"\n    export function printText(text: string, x: number, y: number, foreground = 15, background = 1, speed?: TextSpeed) {\n        const script = _formatText(text, speed === undefined ? TextSpeed.Normal : speed);\n        script.setColors(foreground, background);\n        printScript(script, x, y, TEXT_Z);\n    }\n\n    /**\n     * Prints some text to the screen above a sprite one character at a time.\n     *\n     * @param sprite The sprite to print above\n     * @param text The text to print to the screen\n     * @param foreground The color used to print the text\n     * @param background the color of the background behind the printed text\n     * @param speed the speed at which to print the text\n     */\n    //% blockId=story_sprite_say_text\n    //% block=\"$sprite say $text ||with text color $foreground back color $background $speed\"\n    //% help=github:arcade-story/sprite-say.md\n    //% text.defl=\":)\"\n    //% sprite.shadow=variables_get\n    //% sprite.defl=sprite\n    //% foreground.shadow=colorindexpicker\n    //% foreground.defl=15\n    //% background.shadow=colorindexpicker\n    //% background.defl=1\n    //% inlineInputMode=inline\n    //% blockGap=8\n    //% weight=98\n    //% group=\"Text\"\n    export function spriteSayText(sprite: Sprite, text: string, foreground = 15, background = 1, speed?: TextSpeed) {\n        const script = _formatText(text, speed === undefined ? TextSpeed.Normal : speed);\n        script.setColors(foreground, background);\n        spriteSayScript(sprite, script);\n    }\n\n    function isBreakCharacter(charCode: number) {\n        return charCode <= 32 ||\n            (charCode >= 58 && charCode <= 64) ||\n            (charCode >= 91 && charCode <= 96) ||\n            (charCode >= 123 && charCode <= 126);\n    }\n\n    export function _formatText(text: string, speed: TextSpeed, maxLineLength = 20, maxLinesPerPage = 5): Script {\n        const result = new Script();\n\n        let lastBreakLocation = 0;\n        let lastBreak = 0;\n        let line = 0;\n\n        for (let index = 0; index < text.length; index++) {\n            if (text.charAt(index) === \"\\n\") {\n                result.addLineToCurrentPage(formatLine(text.substr(lastBreak, index - lastBreak)), speed);\n                index++;\n                lastBreak = index;\n                line++;\n            }\n            // Handle \\\\n in addition to \\n because that's how it gets converted from blocks\n            else if (text.charAt(index) === \"\\\\\" && text.charAt(index + 1) === \"n\") {\n                result.addLineToCurrentPage(formatLine(text.substr(lastBreak, index - lastBreak)), speed)\n                index += 2;\n                lastBreak = index\n                line++;\n            }\n            else if (isBreakCharacter(text.charCodeAt(index))) {\n                lastBreakLocation = index;\n            }\n\n            if (index - lastBreak === maxLineLength) {\n                if (lastBreakLocation === index || lastBreakLocation < lastBreak) {\n                    result.addLineToCurrentPage(formatLine(text.substr(lastBreak, maxLineLength)), speed);\n                    lastBreak = index;\n                    line++;\n                }\n                else {\n                    result.addLineToCurrentPage(formatLine(text.substr(lastBreak, lastBreakLocation - lastBreak)), speed);\n                    lastBreak = lastBreakLocation;\n                    line++;\n                }\n            }\n\n            if (line >= maxLinesPerPage) {\n                line = 0;\n                result.newPage();\n            }\n        }\n\n        result.addLineToCurrentPage(formatLine(text.substr(lastBreak, text.length - lastBreak)), speed);\n\n        return result;\n    }\n\n    function formatLine(text: string) {\n        let i = 0;\n        while (text.charAt(i) === \" \") i++;\n        return text.substr(i, text.length);\n    }\n\n    /**\n     * Print some text to the screen within a given box, relative to the camera, and character by character.\n     *\n     * @param text The text to print to the screen\n     * @param x The center x position to print the text at\n     * @param y The center y position to print the text at\n     * @param height The height of the invisible box to print within\n     * @param width The width of the invisible box to print within\n     * @param foreground The color used to print the text\n     * @param background The color of the background behind the printed text\n     * @param speed The speed at which to print the text\n     */\n    //% blockId=story_print_dialog\n    //% block=\"print $text at camera x $x y $y in box width $width height $height||with text color $foreground back color $background $speed\"\n    //% help=github:arcade-story/print-dialog.md\n    //% text.defl=\":)\"\n    //% foreground.shadow=colorindexpicker\n    //% foreground.defl=15\n    //% background.shadow=colorindexpicker\n    //% background.defl=1\n    //% x.defl=80\n    //% y.defl=90\n    //% width.defl=150\n    //% height.defl=50\n    //% inlineInputMode=inline\n    //% blockGap=8\n    //% weight=60\n    //% group=\"Text\"\n    export function printDialog(text: string, x: number, y: number, height: number, width: number, foreground = 15, background = 1, speed?: TextSpeed) {\n        const font = image.getFontForText(text);\n        const script = _formatText(text, speed === undefined ? TextSpeed.Normal : speed, Math.idiv(width - 8, font.charWidth), Math.idiv(height - 8, font.charHeight));\n        script.setColors(foreground, background);\n        printScript(script, x - (width >> 1), y - (height >> 1), TEXT_Z, true, true);\n    }\n\n    /**\n     * Sets the amount of time to pause in between pages of text that are printed out by\n     * the story extension.\n     *\n     * @param pagePauseMillis The time to pause at the end of pages in milliseconds\n     * @param finalPagePauseMillis The time to pause at the end of the final page in milliseconds\n     */\n    //% blockId=story_set_page_pause_length\n    //% block=\"set page pause (ms) $pagePauseMillis and final page pause (ms) $finalPagePauseMillis\"\n    //% help=github:arcade-story/set-page-pause-length.md\n    //% pagePauseMillis.shadow=timePicker\n    //% pagePauseMillis.defl=1000\n    //% finalPagePauseMillis.shadow=timePicker\n    //% finalPagePauseMillis.defl=1000\n    //% inlineInputMode=inline\n    //% blockGap=8\n    //% weight=40\n    //% group=\"Text\"\n    export function setPagePauseLength(pagePauseMillis: number, finalPagePauseMillis: number) {\n        _defaultPagePauseLength = pagePauseMillis;\n        _defaultFinalPagePauseLength = finalPagePauseMillis;\n    }\n\n    /**\n     * Sets whether or not a sound will play whenever a character is printed\n     * to the screen.\n     *\n     * @param enabled Whether or not the sound should play\n     */\n    //% blockId=story_set_sound_enabled\n    //% block=\"set text sound enabled $enabled\"\n    //% help=github:arcade-story/set-sound-enabled.md\n    //% inlineInputMode=inline\n    //% blockGap=8\n    //% weight=30\n    //% group=\"Text\"\n    export function setSoundEnabled(enabled: boolean) {\n        _currentCutscene().soundEnabled = enabled;\n    }\n}","dialog.ts":"namespace story {\n    let stateStack: ConversationState[];\n\n    enum State {\n        Idle,\n        Running,\n        Cancelled\n    }\n\n    class ConversationState {\n        state: State;\n        lastAnswer: string;\n        registeredMenuHandler: boolean;\n        currentTask: story.Task;\n        soundEnabled: boolean;\n        cutsceneQueue: (() => void)[];\n\n        constructor() {\n            this.state = State.Idle;\n            this.soundEnabled = true;\n            this.cutsceneQueue = [];\n        }\n\n        showMenu(choices: string[]) {\n            if (this.state === State.Cancelled) return;\n            if (!this.registeredMenuHandler) {\n                this.registeredMenuHandler = true;\n                story.menu.onMenuOptionSelected((option: string, index: number) => {\n                    this.lastAnswer = option;\n                    story.menu.closeMenu();\n                });\n            }\n\n            let arrows = img`\n                1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n                1 1 1 1 1 1 1 1 1 6 6 6 6 6 6 6 1\n                1 1 1 1 6 1 1 1 1 6 6 6 6 6 6 6 1\n                1 1 1 1 6 1 1 1 1 1 6 6 6 6 6 1 1\n                1 1 1 6 6 6 1 1 1 1 6 6 6 6 6 1 1\n                1 1 1 6 6 6 1 1 1 1 1 6 6 6 1 1 1\n                1 1 6 6 6 6 6 1 1 1 1 6 6 6 1 1 1\n                1 1 6 6 6 6 6 1 1 1 1 1 6 1 1 1 1\n                1 6 6 6 6 6 6 6 1 1 1 1 6 1 1 1 1\n                1 6 6 6 6 6 6 6 1 1 1 1 1 1 1 1 1\n                1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n            `\n            let abutton = img`\n                1 1 1 1 1 1 1 1 1 1 1\n                1 1 1 6 6 6 6 6 1 1 1\n                1 1 6 6 6 6 6 6 6 1 1\n                1 6 6 6 6 1 6 6 6 6 1\n                1 6 6 6 1 6 1 6 6 6 1\n                1 6 6 6 1 1 1 6 6 6 1\n                1 6 6 6 1 6 1 6 6 6 1\n                1 6 6 6 1 6 1 6 6 6 1\n                1 1 6 6 6 6 6 6 6 1 1\n                1 1 1 6 6 6 6 6 1 1 1\n                1 1 1 1 1 1 1 1 1 1 1\n            `\n\n            const arrowText = new story.TextSprite(story.TEXT_Z + 1);\n            arrowText.setText(\"SELECT\");\n            arrowText.setColor(15);\n            arrowText.top = screen.height - (arrows.height >> 1) - (arrowText.getHeight() >> 1);\n\n            const buttonText = new story.TextSprite(story.TEXT_Z + 1);\n            buttonText.setText(\"OK\");\n            buttonText.setColor(15);\n            buttonText.top = screen.height - (arrows.height >> 1) - (buttonText.getHeight() >> 1);\n\n            const arrowIcon = new story.IconSprite(story.TEXT_Z + 1);\n            arrowIcon.top = screen.height - arrows.height;\n            arrowIcon.setIcon(arrows);\n\n            const buttonIcon = new story.IconSprite(story.TEXT_Z + 1);\n            buttonIcon.top = screen.height - abutton.height;\n            buttonIcon.setIcon(abutton);\n\n            const totalWidth = arrowText.getWidth() + buttonText.getWidth() + arrows.width + abutton.width + 4;\n\n            arrowIcon.left = (screen.width >> 1) - (totalWidth >> 1);\n            arrowText.left = arrowIcon.left + arrows.width + 1\n            buttonIcon.left = arrowText.left + arrowText.getWidth() + 2;\n            buttonText.left = buttonIcon.left + abutton.width + 1;\n\n            const backdrop = new story.RectangleSprite(story.TEXT_Z);\n            backdrop.setDimensions(156, arrows.height);\n            backdrop.top = screen.height - backdrop.height;\n            backdrop.left = (screen.width >> 1) - (backdrop.width >> 1);\n\n            story.menu.showMenu(choices, story.menu.MenuStyle.List, story.menu.MenuLocation.BottomHalf);\n            pauseUntil(() => !story.menu.isMenuOpen());\n\n            buttonText.destroy();\n            arrowIcon.destroy();\n            arrowText.destroy();\n            buttonIcon.destroy();\n            backdrop.destroy();\n        }\n\n        cancel() {\n            if (story.menu.isMenuOpen()) {\n                story.menu.closeMenu();\n            }\n            if (this.currentTask && this.currentTask.cancel) {\n                this.currentTask.cancel();\n                this.currentTask = null;\n            }\n            if (this.state === State.Running) {\n                this.state = State.Cancelled;\n            }\n        }\n    }\n\n    /**\n     * Starts a cutscene that runs in the background. There can only\n     * be one cutscene active at a time, so calling this multiple times\n     * will cause the cutscenes to queue up.\n     *\n     * @param callback The code to run inside the cutscene\n     */\n    //% blockId=arcade_story_start_cutscene\n    //% block=\"start cutscene\"\n    //% help=github:arcade-story/start-cutscene.md\n    //% weight=100\n    //% handlerStatement=1\n    //% group=\"Cutscene\"\n    export function startCutscene(callback: () => void) {\n        _currentCutscene().cutsceneQueue.push(callback);\n        if (_currentCutscene().state === State.Idle) {\n            _currentCutscene().state = State.Running\n            control.runInParallel(() => {\n                while (_currentCutscene().cutsceneQueue.length) {\n                    _currentCutscene().state = State.Running\n                    _currentCutscene().cutsceneQueue.shift()();\n                    pause(1)\n                }\n                _currentCutscene().state = State.Idle;\n            });\n        }\n    }\n\n    //% blockId=arcade_story_start_conversation\n    //% block=\"start conversation\"\n    //% weight=100\n    //% handlerStatement=1\n    //% group=\"Cutscene\"\n    //% deprecated=1\n    export function startConveration(callback: () => void) {\n        startCutscene(callback);\n    }\n\n    /**\n     * Prints text out to the bottom half of the screen, one character at a time.\n     * The text is printed on top of white background and this block will pause\n     * until the printing is complete.\n     *\n     * @param text The text to print\n     * @param label An optional label to display above the text\n     */\n    //% blockId=arcade_story_print_character_text\n    //% block=\"print character text $text|| with label $label\"\n    //% help=github:arcade-story/print-character-text.md\n    //% weight=30\n    //% group=\"Text\"\n    //% blockGap=8\n    export function printCharacterText(text: string, label?: string) {\n        if (_currentCutscene().state === State.Cancelled) {\n            return;\n        }\n        const task = printDialog(text, 80, 90, 50, 150);\n\n        if (label) {\n            const padding = 1;\n            const labelText = new story.TextSprite(story.TEXT_Z + 2);\n            labelText.setText(label);\n            labelText.top = 65 - labelText.getHeight();\n            labelText.attachToTask(task);\n            labelText.left = 3;\n\n            const labelBackdrop = new story.RectangleSprite(story.TEXT_Z + 1);\n            labelBackdrop.setDimensions(labelText.getWidth() + (padding << 1), labelText.getHeight() + (padding << 1));\n            labelBackdrop.setColor(6);\n            labelBackdrop.left = labelText.left - padding;\n            labelBackdrop.top = 65 - labelText.getHeight() - padding;\n            labelBackdrop.attachToTask(task);\n        }\n\n        _currentCutscene().currentTask = task;\n        _pauseUntilTaskIsComplete(task);\n    }\n\n    /**\n     * Shows a menu of choices for the player to make and pauses until the player\n     * makes a choice. The menu shown to the player uses the up, down, and A buttons,\n     * so make sure you ignore those button presses while the menu is open.\n     *\n     *\n     * @param choice1 A choice to appear in the list of player choices\n     * @param choice2 A choice to appear in the list of player choices\n     * @param choice3 A choice to appear in the list of player choices\n     * @param choice4 A choice to appear in the list of player choices\n     * @param choice5 A choice to appear in the list of player choices\n     */\n    //% blockId=arcade_story_show_player_choices\n    //% block=\"show player choices $choice1 $choice2 ||$choice3 $choice4 $choice5\"\n    //% help=github:arcade-story/show-player-choices.md\n    //% inlineInputMode=inline\n    //% weight=80\n    //% blockGap=8\n    //% group=\"Menu\"\n    export function showPlayerChoices(choice1: string, choice2: string, choice3?: string, choice4?: string, choice5?: string) {\n        const choices = [choice1];\n        if (choice2) choices.push(choice2);\n        if (choice3) choices.push(choice3);\n        if (choice4) choices.push(choice4);\n\n        _currentCutscene().showMenu(choices);\n    }\n\n    /**\n     * Checks the last choice made by the player in a menu created by \"show player choices\".\n     *\n     * @param choice The text to check against the last choice made\n     * @returns True if the choice matches the last answer and false otherwise\n     */\n    //% blockId=arcade_story_last_answer\n    //% block=\"last answer equals $choice\"\n    //% help=github:arcade-story/last-answer-equals.md\n    //% weight=70\n    //% group=\"Menu\"\n    export function checkLastAnswer(choice: string): boolean {\n        return _currentCutscene().lastAnswer === choice;\n    }\n\n    //% blockId=arcade_story_cancel_conversation\n    //% block=\"cancel conversation\"\n    //% weight=60\n    //% deprecated=1\n    //% group=\"Menu\"\n    export function cancelCurrentConversation() {\n        cancelCurrentCutscene();\n    }\n\n    /**\n     * Gets the text of the last choice made by the player in a menu created\n     * by \"show player choices\".\n     *\n     * @returns True if the menu is open and false otherwise\n     */\n    //% blockId=arcade_story_get_last_answer\n    //% block=\"get last answer\"\n    //% help=github:arcade-story/get-last-answer.md\n    //% weight=60\n    //% blockGap=8\n    //% group=\"Menu\"\n    export function getLastAnswer(): string {\n        return _currentCutscene().lastAnswer;\n    }\n\n    /**\n     * Checks if the menu created by \"show player choices\" is still open.\n     *\n     * @returns True if the menu is open and false otherwise\n     */\n    //% blockId=arcade_story_is_menu_open\n    //% block=\"is menu open\"\n    //% help=github:arcade-story/is-menu-open.md\n    //% weight=50\n    //% group=\"Menu\"\n    export function isMenuOpen(): boolean {\n        return story.menu.isMenuOpen();\n    }\n\n    /**\n     * Cancels the currently active cutscene.\n     */\n    //% blockId=arcade_story_cancel_cutscene\n    //% block=\"cancel cutscene\"\n    //% help=github:arcade-story/cancel-cutscene.md\n    //% weight=50\n    //% blockGap=8\n    //% group=\"Cutscene\"\n    export function cancelCurrentCutscene() {\n        _currentCutscene().cancel();\n    }\n\n    /**\n     * Cancels the currently active cutscene as well as any pending\n     * cutscenes that haven't started yet.\n     */\n    //% blockId=arcade_story_cancel_all_cutscenes\n    //% block=\"cancel all cutscenes\"\n    //% help=github:arcade-story/cancel-all-cutscenes.md\n    //% weight=49\n    //% blockGap=8\n    //% group=\"Cutscene\"\n    export function cancelAllCutscenes() {\n        _currentCutscene().cutsceneQueue = [];\n        cancelCurrentCutscene();\n    }\n\n    function printDialog(text: string, x: number, y: number, height: number, width: number, foreground = 15, background = 1, speed?: story.TextSpeed) {\n        const font = image.getFontForText(text);\n        const script = story._formatText(text, speed === undefined ? story.TextSpeed.Normal : speed, Math.idiv(width - 8, font.charWidth), Math.idiv(height - 8, font.charHeight));\n        script.setColors(foreground, 0);\n\n        const left = x - (width >> 1);\n        const top = y - (height >> 1)\n\n        const bubble = new story.Bubble(story.TEXT_Z, true);\n        bubble.setAlign(left, top);\n        bubble.foregroundColor = script.foregroundColor;\n        bubble.backgroundColor = script.backgroundColor;\n        bubble.pagePauseLength = script.pagePauseMillis;\n        bubble.startMessage(script.pages);\n\n        const backdrop = new story.RectangleSprite(story.TEXT_Z - 1);\n        backdrop.setColor(background);\n        backdrop.setDimensions(width, height);\n        backdrop.left = left;\n        backdrop.top = top;\n        backdrop.attachToTask(bubble);\n\n        return bubble;\n    }\n\n    export function _pauseUntilTaskIsComplete(task: story.Task) {\n        const state = _currentCutscene();\n        pauseUntil(() => task.isDone() || state.state === State.Cancelled);\n    }\n\n    export function _currentCutscene() {\n        if (!stateStack) {\n            stateStack = [];\n\n            game.addScenePushHandler(() => {\n                stateStack.push(new ConversationState());\n            });\n\n            game.addScenePopHandler(() => {\n                if (stateStack.length) {\n                    stateStack[stateStack.length - 1].cancel();\n                    stateStack.pop();\n                }\n            });\n        }\n        if (!stateStack.length) {\n            stateStack.push(new ConversationState());\n        }\n        return stateStack[stateStack.length - 1];\n    }\n}","shapeSprites.ts":"namespace story {\n    export class ShapeSprite extends sprites.BaseSprite {\n        color: number;\n        left: number;\n        top: number;\n        parent: Task;\n\n        constructor(z: number) {\n            super(z);\n            this.left = 0;\n            this.top = 0;\n            this.color = 1;\n        }\n\n        setColor(color: number) {\n            this.color = color;\n        }\n\n        attachToTask(task: Task) {\n            this.parent = task;\n        }\n\n        destroy() {\n            game.currentScene().allSprites.removeElement(this);\n            if (this.parent && !this.parent.isDone()) {\n                if (this.parent.cancel) this.parent.cancel();\n            }\n        }\n\n        __drawCore(camera: scene.Camera) {\n            this.drawShape(this.left, this.top, this.color);\n        }\n\n        __update(camera: scene.Camera, dt: number) {\n            if (this.parent && this.parent.isDone()) {\n                this.destroy();\n            }\n        }\n\n        protected drawShape(left: number, top: number, color: number) {\n            // subclass\n        }\n    }\n\n    export class TextSprite extends ShapeSprite {\n        text: string;\n        \n        setText(text: string) {\n            this.text = text;\n        }\n\n        getWidth() {\n            return this.text ? \n            image.getFontForText(this.text).charWidth * this.text.length : \n            0;\n        }\n\n        getHeight() {\n            return this.text ? \n            image.getFontForText(this.text).charHeight : \n            0;\n        }\n\n        protected drawShape(left: number, top: number, color: number) {\n            if (this.text) {\n                screen.print(this.text, left, top, color);\n            }\n        }\n    }\n\n    export class RectangleSprite extends ShapeSprite {\n        width: number;\n        height: number;\n        isOutline: boolean\n        \n        setDimensions(width: number, height: number) {\n            this.width = width;\n            this.height = height;\n        }\n\n        setSolid(isSolid: boolean) {\n            this.isOutline = !isSolid;\n        }\n\n        protected drawShape(left: number, top: number, color: number) {\n            if (this.width && this.height) {\n                if (this.isOutline) {\n                    screen.drawRect(left, top, this.width, this.height, color);\n                }\n                else {\n                    screen.fillRect(left, top, this.width, this.height, color);\n                }\n            }\n        }\n    }\n\n    export class IconSprite extends ShapeSprite {\n        icon: Image;\n\n        setIcon(icon: Image) {\n            this.icon = icon;\n        }\n\n        protected drawShape(left: number, top: number, color: number) {\n            screen.drawImage(this.icon, left, top);\n        }\n    }\n}","menu.ts":"namespace story.menu {\n    export enum MenuLocation {\n        //% block=\"full screen\"\n        FullScreen,\n        //% block=\"centered\"\n        Center,\n        //% block=\"top half\"\n        TopHalf,\n        //% block=\"right half\"\n        RightHalf,\n        //% block=\"bottom half\"\n        BottomHalf,\n        //% block=\"left half\"\n        LeftHalf,\n        //% block=\"top right\"\n        TopRight,\n        //% block=\"bottom right\"\n        BottomRight,\n        //% block=\"bottom left\"\n        BottomLeft,\n        //% block=\"top left\"\n        TopLeft\n    }\n\n    export enum MenuStyle {\n        //% block=\"grid\"\n        Grid,\n        //% block=\"list\"\n        List\n    }\n\n    class LayoutMetrics {\n        \n        constructor(public left: number, public top: number, public width: number, public height: number) {\n        }\n\n        get right() {\n            return this.left + this.width;\n        }\n\n        get bottom() {\n            return this.top + this.height;\n        }\n    }\n\n    export class MenuSprite extends sprites.BaseSprite {\n        style: MenuStyle;\n        protected location: MenuLocation;\n\n        protected options: string[];\n        protected labels: ScrollingLabel[];\n        protected selectedIndex: number;\n\n        protected foreground: number;\n        protected background: number;\n        protected cursorBackground: number;\n        protected cursorForeground: number;\n        protected open: boolean;\n\n        protected padding: number;\n        protected metrics: LayoutMetrics;\n\n        constructor() {\n            super(100);\n            this.selectedIndex = 0;\n            this.style = MenuStyle.List;\n            this.setLocation(MenuLocation.Center);\n            this.open = false;\n            this.setColors(15, 1, 1, 3);\n            this.padding = 2;\n        }\n\n        setOptions(options: string[]) {\n            this.options = options.slice();\n            this.selectedIndex = 0;\n            this.recreateLabels();\n        }\n\n        setColors(foreground: number, background: number, cursorForeground: number, cursorBackground: number) {\n            this.foreground = Math.max(Math.min(foreground | 0, 15), 0);\n            this.background = Math.max(Math.min(background | 0, 15), 0);\n            this.cursorForeground = Math.max(Math.min(cursorForeground | 0, 15), 0);\n            this.cursorBackground = Math.max(Math.min(cursorBackground | 0, 15), 0);\n        }\n        \n        setStyle(style: MenuStyle) {\n            this.style = style;\n        }\n\n        setLocation(location: MenuLocation) {\n            this.location = location;\n            this.metrics = getLayoutMetrics(location);\n            this.recreateLabels();\n        }\n\n        selectedMenuOption(): string {\n            if (!this.options || !this.options[this.selectedIndex]) {\n                return \"\";\n            }\n\n            return this.options[this.selectedIndex];\n        }\n\n        selectedMenuIndex(): number {\n            return this.selectedIndex;\n        }\n\n        setSelectedIndex(index: number) {\n            const numOptions = this.options ? this.options.length : 0;\n            if (!numOptions) return;\n\n            index |= 0;\n            while (index < 0) index += this.options.length;\n\n            index = index % numOptions;\n\n            if (this.labels && this.labels[this.selectedIndex]) {\n                this.labels[this.selectedIndex].setScrolling(false);\n            }\n\n            this.selectedIndex = index;\n\n            if (this.labels && this.labels[this.selectedIndex]) {\n                this.labels[this.selectedIndex].setScrolling(true);\n            }\n        }\n\n        moveSelectionVertical(up: boolean) {\n            if (this.style === MenuStyle.Grid) {\n                if (up) {\n                    if (this.options && this.options.length & 1) {\n                        if (this.selectedIndex === 0) {\n                            this.setSelectedIndex(this.selectedIndex - 1)\n                        }\n                        else if (this.selectedIndex === 1) {\n                            this.setSelectedIndex(this.selectedIndex - 3)\n                        }\n                        else {\n                            this.setSelectedIndex(this.selectedIndex - 2)\n                        }\n                    }\n                    else {\n                        this.setSelectedIndex(this.selectedIndex - 2)\n                    }\n                }\n                else {\n                    if (this.options && this.options.length & 1 && this.selectedIndex >= this.options.length - 2) {\n                        this.setSelectedIndex(this.selectedIndex + 1)\n                    }\n                    else {\n                        this.setSelectedIndex(this.selectedIndex + 2)\n                    }\n                }\n            }\n            else {\n                if (up) {\n                    this.previous()\n                }\n                else {\n                    this.next();\n                }\n            }\n        }\n\n        moveSelectionHorizontal(left: boolean) {\n            if (this.style === MenuStyle.Grid) {\n                if (this.selectedIndex % 2 === 0) {\n                    this.setSelectedIndex(this.selectedIndex + 1);\n                }\n                else {\n                    this.setSelectedIndex(this.selectedIndex - 1);\n                }\n            }\n        }\n\n        next() {\n            this.setSelectedIndex(this.selectedIndex + 1);\n        }\n\n        previous() {\n            this.setSelectedIndex(this.selectedIndex - 1);\n        }\n\n        setSelectedOption(option: string) {\n            const index = this.options ? this.options.indexOf(option) : -1;\n\n            if (index !== -1) {\n                this.setSelectedIndex(index);\n            }\n        }\n\n        isOpen(): boolean {\n            return this.open;\n        }\n\n        setMenuOpen(open: boolean) {\n            this.open = open;\n        }\n\n        destroy() {\n            game.currentScene().allSprites.removeElement(this);\n        }\n\n        __visible(): boolean {\n            return this.open;\n        }\n\n        __drawCore(camera: scene.Camera) {\n            if (this.background) {\n                screen.fillRect(\n                    this.metrics.left,\n                    this.metrics.top,\n                    this.metrics.width,\n                    Math.min(\n                        this.metrics.height,\n                        this.contentHeight() + this.padding\n                    ),\n                    this.background\n                );\n            }\n\n            if (this.style === MenuStyle.Grid) {\n                this.drawGridMenu();\n            }\n            else {\n                this.drawListMenu();\n            }\n        }\n\n        protected getMaxLabelWidth() {\n            if (this.style === MenuStyle.Grid) {\n                return (this.metrics.width - (this.padding * 3)) >> 1;\n            }\n            return this.metrics.width - (this.padding << 1);\n        }\n\n        protected recreateLabels() {\n            this.labels = [];\n            if (!this.options) return;\n\n            const labelWidth = this.getMaxLabelWidth();\n\n            for (const option of this.options) {\n                this.labels.push(new ScrollingLabel(option, labelWidth));\n            }\n\n            this.setSelectedIndex(this.selectedMenuIndex())\n        }\n\n        protected contentHeight() {\n            let h = 0;\n            for (let i = 0; i < this.labels.length; i++) {\n                h += this.padding;\n                h += this.labels[i].font.charHeight;\n            }\n            return h\n        }\n\n        protected drawGridMenu() {\n            let current: ScrollingLabel;\n\n            let top = this.metrics.top + this.padding;\n            let left = this.metrics.left + this.padding;\n\n            for (let i = 0; i < this.labels.length; i++) {\n                current = this.labels[i];\n\n                if (i === this.selectedIndex) {\n                    screen.fillRect(left - 1, top - 1, current.width + 2, current.font.charHeight + 2, this.cursorBackground);\n                    current.draw(left, top, this.cursorForeground);\n                }\n                else {\n                    current.draw(left, top, this.foreground);\n                }\n\n                if (i % 2 === 1) {\n                    left = this.metrics.left + this.padding;\n                    top += current.font.charHeight + this.padding;\n                }\n                else {\n                    left += current.width + this.padding;\n                }\n            }\n        }\n\n        protected drawListMenu() {\n            let current: ScrollingLabel;\n\n            let top = this.metrics.top + this.padding;\n            let left = this.metrics.left + this.padding;\n\n            for (let i = 0; i < this.labels.length; i++) {\n                current = this.labels[i];\n                if (i === this.selectedIndex) {\n                    screen.fillRect(left - 1, top - 1, current.width + 2, current.font.charHeight + 2, this.cursorBackground);\n                    current.draw(left, top, this.cursorForeground);\n                }\n                else {\n                    current.draw(left, top, this.foreground);\n                }\n\n                top += current.font.charHeight + this.padding\n            }\n        }\n    }\n\n    class ScrollingLabel {\n        public offset: number;\n\n        public stage: number;\n        public timer: number;\n        public scrolling: boolean;\n        public pauseTime: number;\n        public maxCharacters: number;\n        public maxOffset: number;\n        public width: number;\n        public font: image.Font;\n        public partialCanvas: Image;\n\n        constructor(public text: string, maxWidth: number) {\n            this.scrolling = false;\n\n            this.pauseTime = 1000;\n            this.timer = this.pauseTime;\n            this.stage = 0;\n            this.offset = 0;\n            this.width = maxWidth;\n\n            this.font = image.getFontForText(this.text);\n\n            const fullLength = this.text.length * this.font.charWidth;\n            this.maxCharacters = Math.idiv(maxWidth, this.font.charWidth);\n            this.maxOffset = fullLength - this.maxCharacters * this.font.charWidth;\n            this.partialCanvas = image.create(this.font.charWidth, this.font.charHeight);\n        }\n\n        setScrolling(scrolling: boolean) {\n            if (this.scrolling !== scrolling) {\n                this.stage = 0;\n                this.offset = 0;\n                this.scrolling = scrolling;\n            }\n        }\n\n        draw(left: number, top: number, color: number) {\n            const startIndex = Math.idiv(this.offset, this.font.charWidth);\n            const letterOffset = startIndex * this.font.charWidth - this.offset;\n\n            if (!this.scrolling) {\n                this.offset = 0;\n            }\n            else if (this.stage === 1) {\n                this.offset++;\n                if (this.offset >= this.maxOffset) {\n                    this.stage++;\n                    this.offset = Math.max(this.maxOffset, 0);\n                }\n            }\n            else {\n                if (this.stage === 0) {\n                    this.offset = 0;\n                }\n                else if (this.stage === 2) {\n                    this.offset = Math.max(this.maxOffset, 0);\n                }\n\n                this.timer -= game.currentScene().eventContext.deltaTimeMillis;\n\n                if (this.timer < 0) {\n                    this.stage = (this.stage + 1) % 3;\n                    this.timer = this.pauseTime;\n                }\n            }\n\n            if (letterOffset) {\n                this.partialCanvas.fill(0);\n                this.partialCanvas.print(this.text.charAt(startIndex), letterOffset, 0, color, this.font)\n                screen.drawTransparentImage(this.partialCanvas, left, top);\n            }\n            else {\n                screen.print(this.text.charAt(startIndex), left, top, color, this.font);\n            }\n\n            for (let i = 1; i < this.maxCharacters; i++) {\n                screen.print(\n                    this.text.charAt(startIndex + i),\n                    left + i * this.font.charWidth + letterOffset,\n                    top,\n                    color,\n                    this.font\n                );\n            }\n        }\n    }\n\n    function getLayoutMetrics(layout: MenuLocation) {\n        const padding = 2;\n\n        const maxWidth = screen.width - (padding << 1);\n        const maxHeight = screen.height - (padding << 1);\n\n        switch (layout) {\n            case MenuLocation.FullScreen:\n                return new LayoutMetrics(padding, padding, maxWidth, maxHeight);\n            case MenuLocation.Center:\n                return new LayoutMetrics(0, 0, 0, 0);\n            case MenuLocation.TopHalf:\n                return new LayoutMetrics(padding, padding, maxWidth, maxHeight >> 1);\n            case MenuLocation.RightHalf:\n                return new LayoutMetrics(screen.width >> 1, padding, maxWidth >> 1, maxHeight);\n            case MenuLocation.BottomHalf:\n                return new LayoutMetrics(padding, screen.height >> 1, maxWidth, maxHeight >> 1);\n            case MenuLocation.LeftHalf:\n                return new LayoutMetrics(padding, padding, maxWidth >> 1, maxHeight);\n            case MenuLocation.TopRight:\n                return new LayoutMetrics(screen.width >> 1, padding, maxWidth >> 1, maxHeight >> 1);\n            case MenuLocation.BottomRight:\n                return new LayoutMetrics(screen.width >> 1, screen.height >> 1, maxWidth >> 1, maxHeight >> 1);\n            case MenuLocation.BottomLeft:\n                return new LayoutMetrics(padding, screen.height >> 1, maxWidth >> 1, maxHeight >> 1);\n            case MenuLocation.TopLeft:\n                return new LayoutMetrics(padding, padding, maxWidth >> 1, maxHeight >> 1);\n        }\n    }\n}","menuState.ts":"namespace story.menu {\n    let state: _BlockMenuState;\n    let sceneStack: _BlockMenuState[];\n\n    export function showMenu(options: string[], style: MenuStyle, location: MenuLocation) {\n        const state = _getState();\n\n        state.menu.setOptions(options);\n        state.menu.setStyle(style);\n        state.menu.setLocation(location);\n        state.menu.setMenuOpen(true);\n    }\n\n    export function closeMenu() {\n        const state = _getState();\n        state.menu.setMenuOpen(false);\n    }\n\n    export function setColors(foreground: number, background: number) {\n        const state = _getState();\n        state.menu.setColors(foreground, background, background, foreground);\n    }\n\n    export function selectedMenuOption(): string {\n        const state = _getState();\n        return state.menu.selectedMenuOption();\n    }\n\n    export function selectedMenuIndex(): number {\n        const state = _getState();\n        return state.menu.selectedMenuIndex();\n    }\n\n    export function isMenuOpen(): boolean {\n        const state = _getState();\n        return state.menu.isOpen();\n    }\n\n    export function onMenuOptionSelected(handler: (option: string, index: number) => void) {\n        const state = _getState();\n        state.addHandler(handler);\n    }\n\n    export class _BlockMenuState {\n        menu: MenuSprite;\n        handlers: ((option: string, index: number) => void)[];\n        controlsEnabled: boolean;\n\n        constructor() {\n            this.menu = new MenuSprite();\n            this.handlers = [];\n            this.controlsEnabled = true;\n        }\n\n        addHandler(handler: ((option: string, index: number) => void)) {\n            if (handler) {\n                this.handlers.push(handler);\n            }\n        }\n\n        runHandlers(option: string, index: number) {\n            if (this.handlers.length) {\n                control.runInParallel(() => {\n                    for (const handler of this.handlers) {\n                        handler(option, index)\n                    }\n                });\n            }\n        }\n\n        destroy() {\n            this.menu.destroy();\n        }\n    }\n\n    enum button {\n        u = 1,\n        r = 1 << 1,\n        d = 1 << 2,\n        l = 1 << 3,\n        a = 1 << 4,\n        b = 1 << 5\n    }\n\n    export function _init() {\n        if (sceneStack) return;\n        sceneStack = [];\n        state = new _BlockMenuState();\n\n        // can't use controller events because it would override\n        // the user's controller handlers. this works okay but\n        // it's a little glitchy in the grid layout\n        let debounce = 100;\n        control.runInParallel(function() {\n            while (true) {\n                controller.pauseUntilAnyButtonIsPressed();\n                if (!state.controlsEnabled) continue;\n\n                if (state.menu.style === MenuStyle.Grid) {\n                    debounce = 150\n                }\n                else {\n                    debounce = 100;\n                }\n\n                if (controller.A.isPressed()) {\n                    for (const handler of state.handlers) {\n                        handler(state.menu.selectedMenuOption(), state.menu.selectedMenuIndex());\n                    }\n\n                    pause(debounce);\n                }\n                if (controller.up.isPressed()) {\n                    state.menu.moveSelectionVertical(true);\n                    pause(debounce);\n                }\n                if (controller.down.isPressed()) {\n                    state.menu.moveSelectionVertical(false);\n                    pause(debounce);\n                }\n                if (controller.left.isPressed()) {\n                    state.menu.moveSelectionHorizontal(true);\n                    pause(debounce);\n                }\n                if (controller.right.isPressed()) {\n                    state.menu.moveSelectionHorizontal(false);\n                    pause(debounce);\n                }\n            }\n        })\n\n        game.addScenePushHandler(function (oldScene: scene.Scene) {\n            sceneStack.push(state);\n            state = new _BlockMenuState();\n        });\n\n        game.addScenePopHandler(function (oldScene: scene.Scene) {\n            if (sceneStack.length) {\n                state = sceneStack.pop();\n            }\n            else {\n                if (state) {\n                    state.destroy();\n                }\n                state = new _BlockMenuState();\n            }\n        });\n    }\n\n    export function _getState() {\n        _init();\n        return state;\n    }\n}\n","cancel-current-text.md":"# cancel current text\n\nRemoves all text that is currently being drawn to the screen by blocks from the Story extension.\n\nThis will also cause any currently paused text blocks to immediately advance.\n\n```sig\nstory.clearAllText()\n```\n\n## Example #example\n\nThis example uses the cancel current text block inside a button event to allow the player to skip text in a cutscene.\n\n```blocks\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    story.clearAllText()\n})\nstory.startCutscene(function () {\n    story.printDialog(\"This game contains an epic tale of the rise and fall of the kingdom of Chambrela!\", 80, 60, 120, 150)\n    story.printDialog(\"One that couldn't possibly be understood without knowing the history of the royal family, as well as their ancestry\", 80, 60, 120, 150)\n    story.printDialog(\"Our story begins with Prince Rupert, whose father, Bartholomew, was a little known fish merchant\", 80, 60, 120, 150)\n    story.printDialog(\"Before marrying the queen, Bartholomew....\", 80, 60, 120, 150)\n})\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```\n","cancel-cutscene.md":"# cancel cutscene\n\nCancels the current cutscene that is running within a [start cutscene]() block. This will only cancel blocks from the \"Story\" category; other blocks like [ask for string](/reference/game/ask-for-string) will not be cancelled.\n\n```sig\nstory.cancelCurrentCutscene()\n```\n\n## Example #example\n\nIn this example, we use [cancel cutscene]() to interrupt a conversation when the A button is pressed.\n\n```blocks\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    story.cancelCurrentCutscene()\n    story.startCutscene(function () {\n        story.printCharacterText(\"OBJECTION!!!!\", \"Prosecutor\")\n        story.printCharacterText(\"That video is clearly using clips from the popular video \\\"CAT LUVS SUNBEAM LOL PLZ SUBSCRIBE\\\"\", \"Prosecutor\")\n    })\n})\nstory.startCutscene(function () {\n    story.printCharacterText(\"Your honor, I think you'll find that there is no way my client could have been present when the heist occurred\", \"Defense\")\n    story.printCharacterText(\"As you can see, the surveillance footage clearly indicates that my client was playing a charity tennis match against a cat at the time\", \"Defense\")\n    story.printCharacterText(\"He lost three straight sets. Who would make up such a shameful display?\", \"Defense\")\n    story.printCharacterText(\"My client sits here, ashamed, knowing that the world now sees that a cat with no interest in the sport could beat them in a game of tennis\", \"Defense\")\n    story.printCharacterText(\"Who would allow themselves to be subjected to such humiliation? The cat was napping in a sunbeam for most of the second set\", \"Defense\")\n    story.printCharacterText(\"My client had nothing to do with this terrible crime\", \"Defense\")\n})\n\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```\n\n\n","last-answer-equals.md":"# last answer equals\n\nChecks to see if the last answer selected from a [show player choices]() block is equal to a specific string.\n\n```sig\nstory.checkLastAnswer(\"hello\")\n```\n\n## Parameters\n\n* **text**: a [string](/types/string) that contains the answer value to check\n\n## Example #example\n\nIn this example, we show how you could do a character selection scene at the beginning of a game.\nWe give the player three choices for a job, and then change the text and character image based on their choice.\n\n```blocks\nlet sprite = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . b b b b b b b . . . .\n    . . . . . 3 3 3 3 3 3 b . . . .\n    . . . . . 1 3 3 3 1 3 b . . . .\n    . . . . . 3 3 3 3 3 3 3 . . . .\n    . . . . . 3 3 3 3 3 3 3 . . . .\n    . . . . a a a b a a a a a . . .\n    . . . a . a c b a a a a . a . .\n    . . . a . a a b a b b a . a . .\n    . . . a . a c b a a a a . a . .\n    . . . a . a a b a a a a . a . .\n    . . . . . e e e e e e e . . . .\n    . . . . . c c c c c c c . . . .\n    . . . . . c . . . . . c . . . .\n    `, SpriteKind.Player)\nsprite.setPosition(80, 40)\nscene.setBackgroundColor(13)\nstory.startCutscene(function () {\n    story.printDialog(\"Hey there!\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VeryFast)\n    story.printDialog(\"Welcome to your first day at the adventurer's guild!\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VeryFast)\n    story.printDialog(\"What job are you signing up for?\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VeryFast)\n    story.showPlayerChoices(\"Warrior\", \"Wizard\", \"Bard\")\n    if (story.checkLastAnswer(\"Warrior\")) {\n        sprite.setImage(img`\n            . . . . . . . . . . . . . . . .\n            . b . . . . . . . . . . . . . .\n            . b . . . . . . . . . . . . . .\n            . b . . . b b b b b b b . . . .\n            . b . . . 3 3 3 3 3 3 b . . . .\n            . b . . . 1 3 3 3 1 3 b . . . .\n            . b . . . 3 3 3 3 3 3 3 . . . .\n            6 6 6 . . 3 3 3 3 3 3 3 . . . .\n            . a a a a a a b a a a a a . . .\n            . 6 . . . a c b a a a a . a . .\n            . . . . . a a b a b b a . a . .\n            . . . . . a c b a a a 6 6 6 6 6\n            . . . . . a a b a a a 6 b b b 6\n            . . . . . e e e e e e 6 b b b 6\n            . . . . . c c c c c c c 6 b 6 .\n            . . . . . c . . . . . c . 6 . .\n            `)\n        story.printDialog(\"Ha, ha, ha, nice! More of the smashin' stuff type, are ya?\", 80, 90, 50, 150)\n        story.printDialog(\"We've got lots of that type around hered\", 80, 90, 50, 150)\n        story.printDialog(\"Make yourself at home!\", 80, 90, 50, 150)\n    } else if (story.checkLastAnswer(\"Wizard\")) {\n        sprite.setImage(img`\n            . . . . . . . . 8 . . . . . . .\n            . . . . . . . 8 8 8 . . . . . .\n            . . . . . . 8 8 8 8 8 . . . . .\n            . . . . . . 8 8 8 8 8 . . . . .\n            . . . . . 8 8 8 8 8 8 8 . . . .\n            . . . . 8 8 8 8 8 8 8 8 8 . . .\n            . 2 . . . 3 3 3 3 3 3 b . . . .\n            . e . . . 1 3 3 3 1 3 b . . . .\n            . e . . . 3 3 3 3 3 3 3 . . . .\n            . e . . . 3 3 3 3 3 3 3 . . . .\n            . e 6 6 6 6 4 6 6 6 6 6 6 . . .\n            . e . . . 6 8 6 6 6 6 6 . 6 . .\n            . e . . . 6 8 6 6 6 6 6 . 6 . .\n            . e . . . 8 8 8 6 6 6 6 . 6 . .\n            . e . . . 8 8 8 6 6 6 6 . 6 . .\n            . e . . . 8 8 8 6 6 6 6 . . . .\n            . . . . . 8 8 8 6 6 6 6 . . . .\n            . . . . . 8 8 8 6 6 6 6 . . . .\n            `)\n        story.printDialog(\"WHOA THAT'S SO COOL!\", 80, 90, 50, 150)\n        story.printDialog(\"So you can do like spells and incantations and such?\", 80, 90, 50, 150)\n        story.printDialog(\"No foolin'!? Well I'm sure you'll have no trouble handling yourself here\", 80, 90, 50, 150)\n    } else if (story.checkLastAnswer(\"Bard\")) {\n        sprite.setImage(img`\n            . . . . . . . . . . . . . . . .\n            . . . . . . . . . . . . . . f f\n            . . f f . . . . . . . . . . f .\n            . . f . . b b b b b b b . . f .\n            . . f . . 3 3 3 3 3 3 b . f f .\n            . f f . . 1 3 3 3 1 3 b . f f .\n            . f f . . 3 3 3 3 3 3 3 . . . .\n            . . . . . 3 3 3 3 3 3 3 . . . .\n            . . . a a a a b a a a a a . . .\n            e 6 6 e . a c b a a a a . a . .\n            e . a e . a a b a b b a . a . .\n            e 6 6 e . a c b a a a a . a . .\n            . e e . . a a b a a a a . a . .\n            . . . . . e e e e e e e . . . .\n            . . . . . c c c c c c c . . . .\n            . . . . . c . . . . . c . . . .\n            `)\n        story.printDialog(\"Oh, nice. Everyone is always so serious around here\", 80, 90, 50, 150)\n        story.printDialog(\"We could really use a ballad or two to lighten the mood\", 80, 90, 50, 150)\n    }\n})\n\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","print-character-text.md":"# print character text\n\nPrints some text relative to the camera at the bottom of the screen. Can also include a label for a character name.\n\n```sig\nstory.printCharacterText(\"here's some text\", \"character name\")\n```\n\n## Parameters\n\n* **text**: a [string](/types/string) that contains the text to print to the screen\n* **label**: a [string](/types/string) to display above the text as a label\n\n## Example #example\n\nIn this example, we show a conversation between two characters named \"Murphy\" and \"Clyde\".\nWe also create two sprites to give the character's expressive protraits that change when they speak.\n\n```blocks\nlet murphy: Sprite = null\nlet clyde: Sprite = null\nstory.startCutscene(function () {\n    clyde = sprites.create(img`\n        ................................................................................\n        ...................................cc...........................................\n        ............................eeeeccceccccc.......................................\n        .........................eeeecccceeeeeeeccc.....................................\n        .......................eeeeeceeeeeeeeeeeeeec....................................\n        ......................eeeeecceeeeeeeeeeeeeec....................................\n        .....................eeeeeeceeebbbbbbbbbbcc.....................................\n        .....................eeeeeccbbbbddddddddb.......................................\n        ....................eeeeeebbddddddddddddd.......................................\n        ....................eeeebbbddddffffdddfff.......................................\n        ...................eeeebbdddddfdddddddddd.......................................\n        ...................eebbbddddddddddddddbbbb......................................\n        ...................eebbdddddddddddddddbddb......................................\n        .................ddddddddddddddddddbdddddd......................................\n        .................dddddddddddddddddbbdddfff......................................\n        .................dbbddddddddddddddbddffff.......................................\n        .................ddddddddddddddddbdddffff.......................................\n        ..................dbddddddddddddddddddfffff.....................................\n        ..................ddddbbddddddddddddddddddd.....................................\n        .......................bddddddddddddddddddd.....................................\n        .......................bbbdddddddddbddddddd.....................................\n        ........................bbbbddddddddbddddd......................................\n        ..........................bbdddddddddbdd........................................\n        ...........................bbbbddddddd..........................................\n        ........................444bbbddddd.............................................\n        .....................eeee44ddddddd4.............................................\n        .................eeeeeeee4444dddd44ee...........................................\n        ...............eeeeeeeeee4444444444cee..........................................\n        ..............eeeeeeeeeeee444444c44cce..........................................\n        .............eeeeeeeeeeeeee4444ccc4cce..........................................\n        ............eeeeeeeeeeeeeeec444ccccccee.........................................\n        ...........eeeeeeeeceeeeeecccccccccccee.........................................\n        ...........eeeeeeeeceeeeeecccccc44cccee.........................................\n        ..........eeeeeeeeeceeeeeccccccc44cccee.........................................\n        ..........eeeeeeeecceeeecccccccccccccee.........................................\n        ..........eeeeeeeecceeeccccccccccccceee.........................................\n        .........eeeeeeeeeeceeeccccccccccccceee.........................................\n        .........eeeeeeeeeecccccccccccccccceeee.........................................\n        .........eeeeeeeeeeeecccccccccc44ceeeee.........................................\n        .........eeeeeeeeeeeeeeeccccccc44ceeeeee........................................\n        .........eeeeeeeeeeeeeeeeeeecccecceeeeee........................................\n        .........eeeeeeeeeeeeeeeeeeeeeeccccceeee..eeee..................................\n        .........eeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.eeeeeeee...............................\n        .........eeeeeeeeeeeeeeeeeeeeeeeeeeeeddddeeeeeeee...............................\n        ..........eeeeeeeeeeeeeeeeeeeeeeeeeedddddddeeeeee...............................\n        ...........eeeeeeeeeeeeeeeeeeeeeeeeedddddddb..eee...............................\n        ...........cccceeeeeccccceeeeeecceeeddddddd....ee...............................\n        ...........eeeccccccccccccccccccceeedddddbb....ee...............................\n        ............eeeeeeecccccccceccccceeebbbddd.....ee...............................\n        ............eeeeeeeeeeeeeeeeeccceeee.bbbdd.....ee...............................\n        ............eeeeeeeeeeeeeeeeeeeeeeee..bb.......ee...............................\n        ............eeeeeeeeeeeeeeeeeeeeeeee...........ee...............................\n        ............eeeeeeeeeeeeeeeeeeeeeecc...........ee...............................\n        ............ceeeeeeeeeeeeeeeeeeeeecc...........ee...............................\n        ............ceeeeeeeeeeeeeeeeccccccc...........ee...............................\n        ............cccceeeecccccccccccccccc...........ee...............................\n        ............cccccccccccccccccccccccc...........ee...............................\n        ............ccccccccccccccccccccccc............ee...............................\n        ............cccccccccccccccccccccccc...........ee...............................\n        ............cccccccccccccccccccccccc...........ee...............................\n        `, SpriteKind.Player)\n    clyde.bottom = 65\n    clyde.left = 0\n    story.printCharacterText(\"Hey Murphy, how's it going?\", \"Clyde\")\n    clyde.setImage(img`\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ..........................eeeeeeeeeeeee.........................................\n        ........................eeeeeeeeeeeeeee.........................................\n        .......................eeeeeeeeeeeecccccee......................................\n        ......................eeeeeeeeeecccceeecccc.....................................\n        .....................eeeeeeeecccceeeeeeeeeeec...................................\n        .....................eeeeeeccceeeeeeeeeeeeeec...................................\n        ....................eeeeeeceeeeeeeeeeeeeccccc...................................\n        ....................eeeeeebbbbbbbbbbbbbbbb......................................\n        ....................eebbbbbddddddddddddddd......................................\n        ..................ddddddddddddddddddddddff......................................\n        ..................dddddddddddddffffddddddd......................................\n        ..................dbbddddddddddddddddddddd......................................\n        ..................dddddddddddddddddddddddb......................................\n        ...................dbddddddddddddddddddddd......................................\n        ...................ddddbbddddddddddddbddddb.....................................\n        ........................bddddddddbddddbdbbb.....................................\n        ........................bbbdddddbdddddfff.......................................\n        .........................bbbbdddbddddfddd.......................................\n        ........................444bbdddbdddddddd.......................................\n        .....................eeee44dbbbbddddddd.........................................\n        .................eeeeeeee4444dddd44ee...........................................\n        ...............eeeeeeeeee4444444444cee..........................................\n        ..............eeeeeeeeeeee444444c44cce..........................................\n        .............eeeeeeeeeeeeee4444ccc4cce..........................................\n        ............eeeeeeeeeeeeeeec444ccccccee.........................................\n        ...........eeeeeeeeceeeeeecccccccccccee.........................................\n        ...........eeeeeeeeceeeeeecccccc44cccee.........................................\n        ..........eeeeeeeeeceeeeeccccccc44cccee.........................................\n        ..........eeeeeeeecceeeecccccccccccccee.........................................\n        ..........eeeeeeeecceeeccccccccccccceee.........................................\n        .........eeeeeeeeeeceeeccccccccccccceee.........................................\n        .........eeeeeeeeeecccccccccccccccceeee.........................................\n        .........eeeeeeeeeeeecccccccccc44ceeeee.........................................\n        .........eeeeeeeeeeeeeeeccccccc44ceeeeee........................................\n        .........eeeeeeeeeeeeeeeeeeecccecceeeeee........................................\n        .........eeeeeeeeeeeeeeeeeeeeeeccccceeee..eeee..................................\n        .........eeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.eeeeeeee...............................\n        .........eeeeeeeeeeeeeeeeeeeeeeeeeeeeddddeeeeeeee...............................\n        ..........eeeeeeeeeeeeeeeeeeeeeeeeeedddddddeeeeee...............................\n        ...........eeeeeeeeeeeeeeeeeeeeeeeeedddddddb..eee...............................\n        ...........cccceeeeeccccceeeeeecceeeddddddd....ee...............................\n        ...........eeeccccccccccccccccccceeedddddbb....ee...............................\n        ............eeeeeeecccccccceccccceeebbbddd.....ee...............................\n        ............eeeeeeeeeeeeeeeeeccceeee.bbbdd.....ee...............................\n        ............eeeeeeeeeeeeeeeeeeeeeeee..bb.......ee...............................\n        ............eeeeeeeeeeeeeeeeeeeeeeee...........ee...............................\n        ............eeeeeeeeeeeeeeeeeeeeeecc...........ee...............................\n        ............ceeeeeeeeeeeeeeeeeeeeecc...........ee...............................\n        ............ceeeeeeeeeeeeeeeeccccccc...........ee...............................\n        ............cccceeeecccccccccccccccc...........ee...............................\n        ............cccccccccccccccccccccccc...........ee...............................\n        ............ccccccccccccccccccccccc............ee...............................\n        ............cccccccccccccccccccccccc...........ee...............................\n        ............cccccccccccccccccccccccc...........ee...............................\n        `)\n    murphy = sprites.create(img`\n        ................................................................................\n        ...........................................ee...................................\n        .......................................eeeee4eee4444............................\n        .....................................eee4444444eeee4444.........................\n        ....................................e44444444444444e44444.......................\n        ....................................e44444444444444ee44444......................\n        .....................................eebbbbbbbbbb444e444444.....................\n        .......................................bddddddddbbbbee44444.....................\n        .......................................dddddddddddddbb444444....................\n        .......................................fffdddffffddddbbb4444....................\n        .......................................ddddddddddfdddddbb4444...................\n        ......................................bbbbddddddddddddddbbb44...................\n        ......................................bddbdddddddddddddddbb44...................\n        ......................................ddddddbdddddddddddddddddd.................\n        ......................................fffdddbbddddddddddddddddd.................\n        .......................................ffffddbddddddddddddddbbd.................\n        .......................................ffffdddbdddddddddddddddd.................\n        .....................................fffffddddddddddddddddddbd..................\n        .....................................dddddddddddddddddddbbdddd..................\n        .....................................dddddddddddddddddddb.......................\n        .....................................dddddddbdddddddddbbb.......................\n        ......................................dddddbddddddddbbbb........................\n        ........................................ddbdddddddddbb..........................\n        ..........................................dddddddbbbb...........................\n        .............................................dddddbbb222........................\n        .............................................2ddddddd224444.....................\n        ...........................................4422dddd222244444444.................\n        ..........................................44e22222222224444444444...............\n        ..........................................4ee22e222222444444444444..............\n        ..........................................4ee2eee222244444444444444.............\n        .........................................44eeeeee222e444444444444444............\n        .........................................44eeeeeeeeeee444444e44444444...........\n        .........................................44eee22eeeeee444444e44444444...........\n        .........................................44eee22eeeeeee44444e444444444..........\n        .........................................44eeeeeeeeeeeee4444ee44444444..........\n        .........................................444eeeeeeeeeeeee444ee44444444..........\n        .........................................444eeeeeeeeeeeee444e4444444444.........\n        .........................................4444eeeeeeeeeeeeeeee4444444444.........\n        .........................................44444e22eeeeeeeeee444444444444.........\n        ........................................444444e22eeeeeee444444444444444.........\n        ........................................444444ee4eee4444444444444444444.........\n        ..................................eeee..4444eeeee4444444444444444444444.........\n        ...............................eeeeeeee.4444444444444444444444444444444.........\n        ...............................eeeeeeeedddd4444444444444444444444444444.........\n        ...............................eeeeeeddddddd44444444444444444444444444..........\n        ...............................eee..bddddddd4444444444444444444444444...........\n        ...............................ee....ddddddd444ee444444eeeee44444eeee...........\n        ...............................ee....bbddddd444eeeeeeeeeeeeeeeeeee444...........\n        ...............................ee.....dddbbb444eeeee4eeeeeeee4444444............\n        ...............................ee.....ddbbb.4444eee44444444444444444............\n        ...............................ee.......bb..444444444444444444444444............\n        ...............................ee...........444444444444444444444444............\n        ...............................ee...........ee4444444444444444444444............\n        ...............................ee...........ee444444444444444444444e............\n        ...............................ee...........eeeeeee4444444444444444e............\n        ...............................ee...........eeeeeeeeeeeeeeee4444eeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee............eeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        `, SpriteKind.Player)\n    murphy.bottom = 65\n    murphy.right = 160\n    story.printCharacterText(\"Ah, y'know how it is, Clyde. Same circus different clowns\", \"Murphy\")\n    murphy.setImage(img`\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        .........................................4444444444444..........................\n        .........................................444444444444444........................\n        ......................................44eeeee444444444444.......................\n        .....................................eeee444eeee4444444444......................\n        ...................................e44444444444eeee44444444.....................\n        ...................................e44444444444444eee444444.....................\n        ...................................eeeee4444444444444e444444....................\n        ......................................bbbbbbbbbbbbbbbb444444....................\n        ......................................dddddddddddddddbbbbb44....................\n        ......................................ffdddddddddddddddddddddd..................\n        ......................................dddddddffffddddddddddddd..................\n        ......................................dddddddddddddddddddddbbd..................\n        ......................................bddddddddddddddddddddddd..................\n        ......................................dddddddddddddddddddddbd...................\n        .....................................bddddbddddddddddddbbdddd...................\n        .....................................bbbdbddddbddddddddb........................\n        .......................................fffdddddbdddddbbb........................\n        .......................................dddfddddbdddbbbb.........................\n        .......................................ddddddddbdddbb222........................\n        .........................................dddddddbbbbd224444.....................\n        ...........................................4422dddd222244444444.................\n        ..........................................44e22222222224444444444...............\n        ..........................................4ee22e222222444444444444..............\n        ..........................................4ee2eee222244444444444444.............\n        .........................................44eeeeee222e444444444444444............\n        .........................................44eeeeeeeeeee444444e44444444...........\n        .........................................44eee22eeeeee444444e44444444...........\n        .........................................44eee22eeeeeee44444e444444444..........\n        .........................................44eeeeeeeeeeeee4444ee44444444..........\n        .........................................444eeeeeeeeeeeee444ee44444444..........\n        .........................................444eeeeeeeeeeeee444e4444444444.........\n        .........................................4444eeeeeeeeeeeeeeee4444444444.........\n        .........................................44444e22eeeeeeeeee444444444444.........\n        ........................................444444e22eeeeeee444444444444444.........\n        ........................................444444ee2eee4444444444444444444.........\n        ..................................eeee..4444eeeee4444444444444444444444.........\n        ...............................eeeeeeee.4444444444444444444444444444444.........\n        ...............................eeeeeeeedddd4444444444444444444444444444.........\n        ...............................eeeeeeddddddd44444444444444444444444444..........\n        ...............................eee..bddddddd4444444444444444444444444...........\n        ...............................ee....ddddddd444ee444444eeeee44444eeee...........\n        ...............................ee....bbddddd444eeeeeeeeeeeeeeeeeee444...........\n        ...............................ee.....dddbbb444eeeee4eeeeeeee4444444............\n        ...............................ee.....ddbbb.4444eee44444444444444444............\n        ...............................ee.......bb..444444444444444444444444............\n        ...............................ee...........444444444444444444444444............\n        ...............................ee...........ee4444444444444444444444............\n        ...............................ee...........ee444444444444444444444e............\n        ...............................ee...........eeeeeee4444444444444444e............\n        ...............................ee...........eeeeeeeeeeeeeeee4444eeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee............eeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        `)\n    story.printCharacterText(\"I hear ya\", \"Clyde\")\n    murphy.setImage(img`\n        ................................................................................\n        ...........................................ee...................................\n        .......................................eeeee4eee4444............................\n        .....................................eee4444444eeee4444.........................\n        ....................................e44444444444444e44444.......................\n        ....................................e44444444444444ee44444......................\n        .....................................eebbbbbbbbbb444e444444.....................\n        .......................................bddddddddbbbbee44444.....................\n        .......................................dddddddddddddbb444444....................\n        .......................................fffdddffffddddbbb4444....................\n        .......................................ddddddddddfdddddbb4444...................\n        ......................................bbbbddddddddddddddbbb44...................\n        ......................................bddbdddddddddddddddbb44...................\n        ......................................ddddddbdddddddddddddddddd.................\n        ......................................fffdddbbddddddddddddddddd.................\n        .......................................ffffddbddddddddddddddbbd.................\n        .......................................ffffdddbdddddddddddddddd.................\n        .....................................fffffddddddddddddddddddbd..................\n        .....................................dddddddddddddddddddbbdddd..................\n        .....................................dddddddddddddddddddb.......................\n        .....................................dddddddbdddddddddbbb.......................\n        ......................................dddddbddddddddbbbb........................\n        ........................................ddbdddddddddbb..........................\n        ..........................................dddddddbbbb...........................\n        .............................................dddddbbb222........................\n        .............................................2ddddddd224444.....................\n        ...........................................4422dddd222244444444.................\n        ..........................................44e22222222224444444444...............\n        ..........................................4ee22e222222444444444444..............\n        ..........................................4ee2eee222244444444444444.............\n        .........................................44eeeeee222e444444444444444............\n        .........................................44eeeeeeeeeee444444e44444444...........\n        .........................................44eee22eeeeee444444e44444444...........\n        .........................................44eee22eeeeeee44444e444444444..........\n        .........................................44eeeeeeeeeeeee4444ee44444444..........\n        .........................................444eeeeeeeeeeeee444ee44444444..........\n        .........................................444eeeeeeeeeeeee444e4444444444.........\n        .........................................4444eeeeeeeeeeeeeeee4444444444.........\n        .........................................44444e22eeeeeeeeee444444444444.........\n        ........................................444444e22eeeeeee444444444444444.........\n        ........................................444444ee4eee4444444444444444444.........\n        ..................................eeee..4444eeeee4444444444444444444444.........\n        ...............................eeeeeeee.4444444444444444444444444444444.........\n        ...............................eeeeeeeedddd4444444444444444444444444444.........\n        ...............................eeeeeeddddddd44444444444444444444444444..........\n        ...............................eee..bddddddd4444444444444444444444444...........\n        ...............................ee....ddddddd444ee444444eeeee44444eeee...........\n        ...............................ee....bbddddd444eeeeeeeeeeeeeeeeeee444...........\n        ...............................ee.....dddbbb444eeeee4eeeeeeee4444444............\n        ...............................ee.....ddbbb.4444eee44444444444444444............\n        ...............................ee.......bb..444444444444444444444444............\n        ...............................ee...........444444444444444444444444............\n        ...............................ee...........ee4444444444444444444444............\n        ...............................ee...........ee444444444444444444444e............\n        ...............................ee...........eeeeeee4444444444444444e............\n        ...............................ee...........eeeeeeeeeeeeeeee4444eeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee............eeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        `)\n    story.printCharacterText(\"You still doing that curling league on weekends?\", \"Murphy\")\n    murphy.setImage(img`\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        ................................................................................\n        .........................................4444444444444..........................\n        .........................................444444444444444........................\n        ......................................44eeeee444444444444.......................\n        .....................................eeee444eeee4444444444......................\n        ...................................e44444444444eeee44444444.....................\n        ...................................e44444444444444eee444444.....................\n        ...................................eeeee4444444444444e444444....................\n        ......................................bbbbbbbbbbbbbbbb444444....................\n        ......................................dddddddddddddddbbbbb44....................\n        ......................................ffdddddddddddddddddddddd..................\n        ......................................dddddddffffddddddddddddd..................\n        ......................................dddddddddddddddddddddbbd..................\n        ......................................bddddddddddddddddddddddd..................\n        ......................................dddddddddddddddddddddbd...................\n        .....................................bddddbddddddddddddbbdddd...................\n        .....................................bbbdbddddbddddddddb........................\n        .......................................fffdddddbdddddbbb........................\n        .......................................dddfddddbdddbbbb.........................\n        .......................................ddddddddbdddbb222........................\n        .........................................dddddddbbbbd224444.....................\n        ...........................................4422dddd222244444444.................\n        ..........................................44e22222222224444444444...............\n        ..........................................4ee22e222222444444444444..............\n        ..........................................4ee2eee222244444444444444.............\n        .........................................44eeeeee222e444444444444444............\n        .........................................44eeeeeeeeeee444444e44444444...........\n        .........................................44eee22eeeeee444444e44444444...........\n        .........................................44eee22eeeeeee44444e444444444..........\n        .........................................44eeeeeeeeeeeee4444ee44444444..........\n        .........................................444eeeeeeeeeeeee444ee44444444..........\n        .........................................444eeeeeeeeeeeee444e4444444444.........\n        .........................................4444eeeeeeeeeeeeeeee4444444444.........\n        .........................................44444e22eeeeeeeeee444444444444.........\n        ........................................444444e22eeeeeee444444444444444.........\n        ........................................444444ee2eee4444444444444444444.........\n        ..................................eeee..4444eeeee4444444444444444444444.........\n        ...............................eeeeeeee.4444444444444444444444444444444.........\n        ...............................eeeeeeeedddd4444444444444444444444444444.........\n        ...............................eeeeeeddddddd44444444444444444444444444..........\n        ...............................eee..bddddddd4444444444444444444444444...........\n        ...............................ee....ddddddd444ee444444eeeee44444eeee...........\n        ...............................ee....bbddddd444eeeeeeeeeeeeeeeeeee444...........\n        ...............................ee.....dddbbb444eeeee4eeeeeeee4444444............\n        ...............................ee.....ddbbb.4444eee44444444444444444............\n        ...............................ee.......bb..444444444444444444444444............\n        ...............................ee...........444444444444444444444444............\n        ...............................ee...........ee4444444444444444444444............\n        ...............................ee...........ee444444444444444444444e............\n        ...............................ee...........eeeeeee4444444444444444e............\n        ...............................ee...........eeeeeeeeeeeeeeee4444eeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee............eeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        `)\n    story.printCharacterText(\"Yeah, but our team might be breaking up. We lost our vice-skip\", \"Clyde\")\n    story.printCharacterText(\"Sorry to hear that, Clyde\", \"Murphy\")\n    murphy.setImage(img`\n        ................................................................................\n        ...........................................ee...................................\n        .......................................eeeee4eee4444............................\n        .....................................eee4444444eeee4444.........................\n        ....................................e44444444444444e44444.......................\n        ....................................e44444444444444ee44444......................\n        .....................................eebbbbbbbbbb444e444444.....................\n        .......................................bddddddddbbbbee44444.....................\n        .......................................dddddddddddddbb444444....................\n        .......................................fffdddffffddddbbb4444....................\n        .......................................ddddddddddfdddddbb4444...................\n        ......................................bbbbddddddddddddddbbb44...................\n        ......................................bddbdddddddddddddddbb44...................\n        ......................................ddddddbdddddddddddddddddd.................\n        ......................................fffdddbbddddddddddddddddd.................\n        .......................................ffffddbddddddddddddddbbd.................\n        .......................................ffffdddbdddddddddddddddd.................\n        .....................................fffffddddddddddddddddddbd..................\n        .....................................dddddddddddddddddddbbdddd..................\n        .....................................dddddddddddddddddddb.......................\n        .....................................dddddddbdddddddddbbb.......................\n        ......................................dddddbddddddddbbbb........................\n        ........................................ddbdddddddddbb..........................\n        ..........................................dddddddbbbb...........................\n        .............................................dddddbbb222........................\n        .............................................2ddddddd224444.....................\n        ...........................................4422dddd222244444444.................\n        ..........................................44e22222222224444444444...............\n        ..........................................4ee22e222222444444444444..............\n        ..........................................4ee2eee222244444444444444.............\n        .........................................44eeeeee222e444444444444444............\n        .........................................44eeeeeeeeeee444444e44444444...........\n        .........................................44eee22eeeeee444444e44444444...........\n        .........................................44eee22eeeeeee44444e444444444..........\n        .........................................44eeeeeeeeeeeee4444ee44444444..........\n        .........................................444eeeeeeeeeeeee444ee44444444..........\n        .........................................444eeeeeeeeeeeee444e4444444444.........\n        .........................................4444eeeeeeeeeeeeeeee4444444444.........\n        .........................................44444e22eeeeeeeeee444444444444.........\n        ........................................444444e22eeeeeee444444444444444.........\n        ........................................444444ee4eee4444444444444444444.........\n        ..................................eeee..4444eeeee4444444444444444444444.........\n        ...............................eeeeeeee.4444444444444444444444444444444.........\n        ...............................eeeeeeeedddd4444444444444444444444444444.........\n        ...............................eeeeeeddddddd44444444444444444444444444..........\n        ...............................eee..bddddddd4444444444444444444444444...........\n        ...............................ee....ddddddd444ee444444eeeee44444eeee...........\n        ...............................ee....bbddddd444eeeeeeeeeeeeeeeeeee444...........\n        ...............................ee.....dddbbb444eeeee4eeeeeeee4444444............\n        ...............................ee.....ddbbb.4444eee44444444444444444............\n        ...............................ee.......bb..444444444444444444444444............\n        ...............................ee...........444444444444444444444444............\n        ...............................ee...........ee4444444444444444444444............\n        ...............................ee...........ee444444444444444444444e............\n        ...............................ee...........eeeeeee4444444444444444e............\n        ...............................ee...........eeeeeeeeeeeeeeee4444eeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee............eeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        ...............................ee...........eeeeeeeeeeeeeeeeeeeeeeee............\n        `)\n    story.printCharacterText(\"Actually, I played vice-skip in our college team. Haven't played in while though\", \"Murphy\")\n    clyde.setImage(img`\n        ................................................................................\n        ...................................cc...........................................\n        ............................eeeeccceccccc.......................................\n        .........................eeeecccceeeeeeeccc.....................................\n        .......................eeeeeceeeeeeeeeeeeeec....................................\n        ......................eeeeecceeeeeeeeeeeeeec....................................\n        .....................eeeeeeceeebbbbbbbbbbcc.....................................\n        .....................eeeeeccbbbbddddddddb.......................................\n        ....................eeeeeebbddddddddddddd.......................................\n        ....................eeeebbbddddffffdddfff.......................................\n        ...................eeeebbdddddfdddddddddd.......................................\n        ...................eebbbddddddddddddddbbbb......................................\n        ...................eebbdddddddddddddddbddb......................................\n        .................ddddddddddddddddddbdddddd......................................\n        .................dddddddddddddddddbbddddddf.....................................\n        .................dbbddddddddddddddbdffddddf.....................................\n        .................ddddddddddddddddbdddfffffd.....................................\n        ..................dbddddddddddddddddddddddd.....................................\n        ..................ddddbbddddddddddddddddddd.....................................\n        .......................bddddddddddddddddddd.....................................\n        .......................bbbdddddddddbddddddd.....................................\n        ........................bbbbddddddddbddddd......................................\n        ..........................bbdddddddddbdd........................................\n        ...........................bbbbddddddd..........................................\n        ........................444bbbddddd.............................................\n        .....................eeee44ddddddd4.............................................\n        .................eeeeeeee4444dddd44ee...........................................\n        ...............eeeeeeeeee4444444444cee..........................................\n        ..............eeeeeeeeeeee444444c44cce..........................................\n        .............eeeeeeeeeeeeee4444ccc4cce..........................................\n        ............eeeeeeeeeeeeeeec444ccccccee.........................................\n        ...........eeeeeeeeceeeeeecccccccccccee.........................................\n        ...........eeeeeeeeceeeeeecccccc44cccee.........................................\n        ..........eeeeeeeeeceeeeeccccccc44cccee.........................................\n        ..........eeeeeeeecceeeecccccccccccccee.........................................\n        ..........eeeeeeeecceeeccccccccccccceee.........................................\n        .........eeeeeeeeeeceeeccccccccccccceee.........................................\n        .........eeeeeeeeeecccccccccccccccceeee.........................................\n        .........eeeeeeeeeeeecccccccccc44ceeeee.........................................\n        .........eeeeeeeeeeeeeeeccccccc44ceeeeee........................................\n        .........eeeeeeeeeeeeeeeeeeecccecceeeeee........................................\n        .........eeeeeeeeeeeeeeeeeeeeeeccccceeee..eeee..................................\n        .........eeeeeeeeeeeeeeeeeeeeeeeeeeeeeee.eeeeeeee...............................\n        .........eeeeeeeeeeeeeeeeeeeeeeeeeeeeddddeeeeeeee...............................\n        ..........eeeeeeeeeeeeeeeeeeeeeeeeeedddddddeeeeee...............................\n        ...........eeeeeeeeeeeeeeeeeeeeeeeeedddddddb..eee...............................\n        ...........cccceeeeeccccceeeeeecceeeddddddd....ee...............................\n        ...........eeeccccccccccccccccccceeedddddbb....ee...............................\n        ............eeeeeeecccccccceccccceeebbbddd.....ee...............................\n        ............eeeeeeeeeeeeeeeeeccceeee.bbbdd.....ee...............................\n        ............eeeeeeeeeeeeeeeeeeeeeeee..bb.......ee...............................\n        ............eeeeeeeeeeeeeeeeeeeeeeee...........ee...............................\n        ............eeeeeeeeeeeeeeeeeeeeeecc...........ee...............................\n        ............ceeeeeeeeeeeeeeeeeeeeecc...........ee...............................\n        ............ceeeeeeeeeeeeeeeeccccccc...........ee...............................\n        ............cccceeeecccccccccccccccc...........ee...............................\n        ............cccccccccccccccccccccccc...........ee...............................\n        ............ccccccccccccccccccccccc............ee...............................\n        ............cccccccccccccccccccccccc...........ee...............................\n        ............cccccccccccccccccccccccc...........ee...............................\n        `)\n    story.printCharacterText(\"Oh!? That's no problem! We just play for fun. You should come by on Saturday!\", \"Clyde\")\n    story.printCharacterText(\"Maybe I will, Clyde. Maybe I will\", \"Murphy\")\n})\n\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","print-dialog.md":"# print dialog\n\nPrints some left-aligned text onto the screen relative to camera and within a box one character at a time.\n\n```sig\nstory.printDialog(\":)\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VerySlow)\n```\n\n## Parameters\n\n* **text**: a [string](/types/string) that contains the text to print to the screen\n* **x**: a [number](/types/number) representing the center of the box for the text to be printed in on the horizontal axis.\n* **y**: a [number](/types/number) representing the center of the box for the text to be printed in on the vertical axis.\n* **width**: a [number](/types/number) representing the width of the box for the text to be printed in.\n* **height**: a [number](/types/number) representing the height of the box for the text to be printed in.\n* **foreground**: an optional [number](/types/number) color for the text that is printed to the screen\n* **background**: an optional [number](/types/number) color for the rectangle that appears behind the text\n* **speed**: an optional speed that controls how fast the text is printed\n\n## Example #example\n\nIn this example, we create a player and an invisible event trigger. When the player overlaps the trigger, we destroy it and start a cutscene from within the overlap event.\n\n```blocks\nnamespace SpriteKind {\n    export const Duck = SpriteKind.create()\n    export const EventTrigger = SpriteKind.create()\n}\nsprites.onOverlap(SpriteKind.Player, SpriteKind.EventTrigger, function (sprite, otherSprite) {\n    otherSprite.destroy()\n    story.startCutscene(function () {\n        controller.moveSprite(thePlayer, 0, 0)\n        story.spriteMoveToLocation(thePlayer, thePlayer.x, 20, 100)\n        story.printDialog(\"One day as Samantha walked to school, she encountered a duck.\", 80, 90, 50, 150)\n        story.printDialog(\"This had certainly never happened before.\", 80, 90, 50, 150)\n        story.printDialog(\"As she locked eyes with the yellow bird, she realized the gravity of this event. Her life would never be the same again.\", 80, 90, 50, 150)\n        story.spriteMoveToLocation(duck, 180, 20, 100)\n        controller.moveSprite(thePlayer)\n    })\n})\nlet duck: Sprite = null\nlet thePlayer: Sprite = null\nscene.setBackgroundColor(13)\nthePlayer = sprites.create(img`\n    b b 2 b b b b b b b . . .\n    b b 2 b 3 3 3 3 3 3 . . .\n    b . . b 3 3 3 3 3 3 . . .\n    . . . b 3 3 1 3 3 1 . . .\n    . . . b 3 3 3 3 3 3 . . .\n    . . . b 3 3 3 3 3 3 . . .\n    . . . . 3 3 3 3 3 3 . . .\n    . . . a a a a a a a a . .\n    . . a . a a a a a a . a .\n    . . a . a a a a a a . a .\n    . . 3 . a a a a a a . 3 .\n    . . . . e e e e e e . . .\n    . . . . c c c c c c . . .\n    . . . . c . . . . c . . .\n    `, SpriteKind.Player)\nthePlayer.setStayInScreen(true)\ncontroller.moveSprite(thePlayer)\nthePlayer.setPosition(8, 53)\nlet event = sprites.create(img`\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    `, SpriteKind.EventTrigger)\nevent.setFlag(SpriteFlag.Invisible, true)\nduck = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . 5 5 5 . . . . . . . .\n    . . . . . 5 f 5 . . . . . . . .\n    . . . . 4 5 5 5 . . . . . . . .\n    . . . . . . . 5 . . . . . . . .\n    . . . . . . . 5 5 5 5 5 5 5 . .\n    . . . . . . . 5 5 5 5 5 5 . . .\n    . . . . . . . 5 5 5 5 5 5 . . .\n    . . . . . . . . 4 . 4 . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    `, SpriteKind.Duck)\nduck.setPosition(135, 20)\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","print-text.md":"# print text\n\nPrints some text onto the screen at a location one character at a time.\n\n```sig\nstory.printText(\"hello\", 80, 60, 15, 1, story.TextSpeed.VerySlow)\n```\n\n## Parameters\n\n* **text**: a [string](/types/string) that contains the text to print to the screen\n* **x**: a [number](/types/number) representing the x coordinate the text should be centered as it prints\n* **y**: a [number](/types/number) representing the y coordinate the text should be centered as it prints\n* **foreground**: an optional [number](/types/number) color for the text that is printed to the screen\n* **background**: an optional [number](/types/number) color for the rectangle that appears behind the text\n* **speed**: an optional speed that controls how fast the text is printed\n\n## Example #example\n\nCreate a plate sprite and a burger sprite and have the burger bounce around the screen. When the plate overlaps with the burger, show some text asking if it's time to eat. When the overlap stops, show some disappointed text.\n\n```blocks\nnamespace SpriteKind {\n    export const Plate = SpriteKind.create()\n}\nsprites.onOverlap(SpriteKind.Plate, SpriteKind.Food, function (sprite, otherSprite) {\n    if (!(overlapping)) {\n        overlapping = true\n        story.startCutscene(function () {\n            story.printText(\"Time to eat?\", 80, 20)\n        })\n    }\n})\nlet overlapping = false\nlet plateSprite = sprites.create(img`\n    ...............bbbbbbbbbbbbbbbbbbb...............\n    ...........bbbbdd111111111111111ddbbbb...........\n    ........bbbd1111111111111111111111111dbbb........\n    ......bbd11111111dddddddddddddd111111111dbb......\n    ....bbd1111111ddd11111111111111dddd1111111dbb....\n    ...bd111111ddd111111111111111111111ddd111111db...\n    ..bd11111ddd111ddddddddddddddddddd111ddd11111db..\n    .bd11111dd111dddd111111111111111dddd111dd11111db.\n    .b11111d111ddd111111111111111111111ddd111d11111b.\n    bd11111d1ddd1111111111111111111111111ddd1111111db\n    b11111d1ddd111111111111111111111111111ddd1d11111b\n    b11111ddddd111111111111111111111111111ddddd11111b\n    b11111ddddd111111111111111111111111111dddbd11111b\n    b111111dddd111111111111111111111111111dddb111111b\n    bd111111dddd1111111111111111111111111dddbd11111db\n    .b1111111dddd11111111111111111111111dddbd111111b.\n    .bd1111111dbbdd1111111111111111111dddbbd111111db.\n    ..bd11111111dbbdd111111111111111dddbbd1111111db..\n    ...bd111111111dbbbbbbdddddddddddddd111111111db...\n    ....bbd11111111111dbbbbbbbbbddd11111111111dbb....\n    ......bbdd11111111111111111111111111111ddbb......\n    ........bbbdd11111111111111111111111ddbbb........\n    ...........bbbbbddd11111111111dddbbbbb...........\n    ................bbbbbbbbbbbbbbbbb................\n    `, SpriteKind.Plate)\nlet burger = sprites.create(img`\n    ...........ccccc66666...........\n    ........ccc4444444444666........\n    ......cc444444444bb4444466......\n    .....cb4444bb4444b5b444444b.....\n    ....eb4444b5b44444b44444444b....\n    ...ebb44444b4444444444b444446...\n    ..eb6bb444444444bb444b5b444446..\n    ..e6bb5b44444444b5b444b44bb44e..\n    .e66b4b4444444444b4444444b5b44e.\n    .e6bb444444444444444444444bb44e.\n    eb66b44444bb444444444444444444be\n    eb66bb444b5b44444444bb44444444be\n    fb666b444bb444444444b5b4444444bf\n    fcb666b44444444444444bb444444bcf\n    .fbb6666b44444444444444444444bf.\n    .efbb66666bb4444444444444444bfe.\n    .86fcbb66666bbb44444444444bcc688\n    8772effcbbbbbbbbbbbbbbbbcfc22778\n    87722222cccccccccccccccc22226678\n    f866622222222222222222222276686f\n    fef866677766667777776667777fffef\n    fbff877768f86777777666776fffffbf\n    fbeffeefffeff7766688effeeeefeb6f\n    f6bfffeffeeeeeeeeeeeeefeeeeebb6e\n    f66ddfffffeeeffeffeeeeeffeedb46e\n    .c66ddd4effffffeeeeeffff4ddb46e.\n    .fc6b4dddddddddddddddddddb444ee.\n    ..ff6bb444444444444444444444ee..\n    ....ffbbbb4444444444444444ee....\n    ......ffebbbbbb44444444eee......\n    .........fffffffcccccee.........\n    ................................\n    `, SpriteKind.Food)\nburger.setBounceOnWall(true)\nburger.setVelocity(15, 25)\ngame.onUpdate(function () {\n    if (overlapping && !(burger.overlapsWith(plateSprite))) {\n        overlapping = false\n        story.startCutscene(function () {\n            story.printText(\"Awwwww....\", 80, 20)\n        })\n    }\n})\n\n```\n\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","set-page-pause-length.md":"# set page pause length\n\nPrints some left-aligned text onto the screen within a box one character at a time.\n\n```sig\nstory.setPagePauseLength(1000, 1000)\n```\n\n## Parameters\n\n* **page pause length**: a [number](/types/number) of milliseconds that text printed to the screen should pause before advancing to the next page\n* **final page pause length**: a [number](/types/number) of milliseconds that text printed to the screen should pause before disappearing on the final page\n\n\n## Example #example\n\nCreate a cutscene where a duck is asking his computer about the weather, and set the page pause length to 0 to create an effect where it looks like the computer is glitching out. Set it back afterwards to continue the scene.\n\n```blocks\nlet duck = sprites.create(img`\n    . . . . . . . . . . b 5 b . . .\n    . . . . . . . . . b 5 b . . . .\n    . . . . . . b b b b b b . . . .\n    . . . . . b b 5 5 5 5 5 b . . .\n    . . . . b b 5 d 1 f 5 5 d f . .\n    . . . . b 5 5 1 f f 5 d 4 c . .\n    . . . . b 5 5 d f b d d 4 4 . .\n    . b b b d 5 5 5 5 5 4 4 4 4 4 b\n    b d d d b b d 5 5 4 4 4 4 4 b .\n    b b d 5 5 5 b 5 5 5 5 5 5 b . .\n    c d c 5 5 5 5 d 5 5 5 5 5 5 b .\n    c b d c d 5 5 b 5 5 5 5 5 5 b .\n    . c d d c c b d 5 5 5 5 5 d b .\n    . . c b d d d d d 5 5 5 b b . .\n    . . . c c c c c c c c b b . . .\n    . . . . . . . . . . . . . . . .\n    `, SpriteKind.Player)\nduck.setPosition(40, 60)\nlet computer = sprites.create(img`\n    . . . b b b b b b b b b . . . .\n    . . b 1 d d d d d d d 1 b . . .\n    . b 1 1 1 1 1 1 1 1 1 1 1 b . .\n    . b d b c c c c c c c b d b . .\n    . b d c 6 6 6 6 6 6 6 c d b . .\n    . b d c 6 d 6 6 6 6 6 c d b . .\n    . b d c 6 6 6 6 6 6 6 c d b . .\n    . b d c 6 6 6 6 6 6 6 c d b . .\n    . b d c 6 6 6 6 6 6 6 c d b . .\n    . b d c c c c c c c c c d b . .\n    . c b b b b b b b b b b b c . .\n    c b c c c c c c c c c c c b c .\n    c 1 d d d d d d d d d d d 1 c .\n    c 1 d 1 1 d 1 1 d 1 1 d 1 1 c .\n    c b b b b b b b b b b b b b c .\n    c c c c c c c c c c c c c c c .\n    `, SpriteKind.Player)\ncomputer.setPosition(120, 60)\nstory.startCutscene(function () {\n    story.spriteSayText(duck, \"Computer, what's the weather like today?\")\n    story.spriteSayText(computer, \"bzzzt\", 6, 15, story.TextSpeed.VerySlow)\n    story.spriteSayText(duck, \"Uh, computer?\")\n    story.setPagePauseLength(0, 0)\n    for (let index = 0; index < 2; index++) {\n        story.spriteSayText(computer, \"snowy\", 6, 15, story.TextSpeed.VeryFast)\n        story.spriteSayText(computer, \"rainy\", 6, 15, story.TextSpeed.VeryFast)\n        story.spriteSayText(computer, \"clear\", 6, 15, story.TextSpeed.VeryFast)\n        story.spriteSayText(computer, \"hot\", 6, 15, story.TextSpeed.VeryFast)\n        story.spriteSayText(computer, \"mostly sunny\", 6, 15, story.TextSpeed.VeryFast)\n        story.spriteSayText(computer, \"i have no idea\", 6, 15, story.TextSpeed.VeryFast)\n    }\n    story.setPagePauseLength(1000, 1000)\n    story.spriteSayText(duck, \"Okay, we might need to debug a few things...\")\n})\n```\n\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","show-player-choices.md":"# show player choices\n\nDisplays a list of up to five options for the player to choose between and pauses until they make a choice.\nThe list allows the player to move through the options using the UP/DOWN buttons and select an option using the A button.\nThe game will continue running as long as this block is run in the background or in a start cutscene block.\n\n```sig\nstory.showPlayerChoices(\"say hello\", \"say goodbye\")\n```\n\n## Parameters\n\n* **choice1**: a [string](/types/string) that contains a choice for the player to choose between\n* **choice2**: a [string](/types/string) that contains a choice for the player to choose between\n* **choice3**: an optional [string](/types/string) that contains a choice for the player to choose between\n* **choice4**: an optional [string](/types/string) that contains a choice for the player to choose between\n* **choice5**: an optional [string](/types/string) that contains a choice for the player to choose between\n\n## Example #example\n\n## Example #example\n\nIn this example, we show how you could do a character selection scene at the beginning of a game.\nWe give the player three choices for a job, and then change the text and character image based on their choice.\n\n```blocks\nlet sprite = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . b b b b b b b . . . .\n    . . . . . 3 3 3 3 3 3 b . . . .\n    . . . . . 1 3 3 3 1 3 b . . . .\n    . . . . . 3 3 3 3 3 3 3 . . . .\n    . . . . . 3 3 3 3 3 3 3 . . . .\n    . . . . a a a b a a a a a . . .\n    . . . a . a c b a a a a . a . .\n    . . . a . a a b a b b a . a . .\n    . . . a . a c b a a a a . a . .\n    . . . a . a a b a a a a . a . .\n    . . . . . e e e e e e e . . . .\n    . . . . . c c c c c c c . . . .\n    . . . . . c . . . . . c . . . .\n    `, SpriteKind.Player)\nsprite.setPosition(80, 40)\nscene.setBackgroundColor(13)\nstory.startCutscene(function () {\n    story.printDialog(\"Hey there!\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VeryFast)\n    story.printDialog(\"Welcome to your first day at the Adventurer's Guild!\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VeryFast)\n    story.printDialog(\"What job are you signing up for?\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VeryFast)\n    story.showPlayerChoices(\"Warrior\", \"Wizard\", \"Bard\")\n    if (story.checkLastAnswer(\"Warrior\")) {\n        sprite.setImage(img`\n            . . . . . . . . . . . . . . . .\n            . b . . . . . . . . . . . . . .\n            . b . . . . . . . . . . . . . .\n            . b . . . b b b b b b b . . . .\n            . b . . . 3 3 3 3 3 3 b . . . .\n            . b . . . 1 3 3 3 1 3 b . . . .\n            . b . . . 3 3 3 3 3 3 3 . . . .\n            6 6 6 . . 3 3 3 3 3 3 3 . . . .\n            . a a a a a a b a a a a a . . .\n            . 6 . . . a c b a a a a . a . .\n            . . . . . a a b a b b a . a . .\n            . . . . . a c b a a a 6 6 6 6 6\n            . . . . . a a b a a a 6 b b b 6\n            . . . . . e e e e e e 6 b b b 6\n            . . . . . c c c c c c c 6 b 6 .\n            . . . . . c . . . . . c . 6 . .\n            `)\n        story.printDialog(\"Ha, ha, ha, nice! More of the smashin' stuff type, are ya?\", 80, 90, 50, 150)\n        story.printDialog(\"We've got lots of that type around here\", 80, 90, 50, 150)\n        story.printDialog(\"Make yourself at home!\", 80, 90, 50, 150)\n    } else if (story.checkLastAnswer(\"Wizard\")) {\n        sprite.setImage(img`\n            . . . . . . . . 8 . . . . . . .\n            . . . . . . . 8 8 8 . . . . . .\n            . . . . . . 8 8 8 8 8 . . . . .\n            . . . . . . 8 8 8 8 8 . . . . .\n            . . . . . 8 8 8 8 8 8 8 . . . .\n            . . . . 8 8 8 8 8 8 8 8 8 . . .\n            . 2 . . . 3 3 3 3 3 3 b . . . .\n            . e . . . 1 3 3 3 1 3 b . . . .\n            . e . . . 3 3 3 3 3 3 3 . . . .\n            . e . . . 3 3 3 3 3 3 3 . . . .\n            . e 6 6 6 6 4 6 6 6 6 6 6 . . .\n            . e . . . 6 8 6 6 6 6 6 . 6 . .\n            . e . . . 6 8 6 6 6 6 6 . 6 . .\n            . e . . . 8 8 8 6 6 6 6 . 6 . .\n            . e . . . 8 8 8 6 6 6 6 . 6 . .\n            . e . . . 8 8 8 6 6 6 6 . . . .\n            . . . . . 8 8 8 6 6 6 6 . . . .\n            . . . . . 8 8 8 6 6 6 6 . . . .\n            `)\n        story.printDialog(\"WHOA THAT'S SO COOL!\", 80, 90, 50, 150)\n        story.printDialog(\"So you can do like spells and incantations and such?\", 80, 90, 50, 150)\n        story.printDialog(\"No foolin'!? Well I'm sure you'll have no trouble handling yourself here\", 80, 90, 50, 150)\n    } else if (story.checkLastAnswer(\"Bard\")) {\n        sprite.setImage(img`\n            . . . . . . . . . . . . . . . .\n            . . . . . . . . . . . . . . f f\n            . . f f . . . . . . . . . . f .\n            . . f . . b b b b b b b . . f .\n            . . f . . 3 3 3 3 3 3 b . f f .\n            . f f . . 1 3 3 3 1 3 b . f f .\n            . f f . . 3 3 3 3 3 3 3 . . . .\n            . . . . . 3 3 3 3 3 3 3 . . . .\n            . . . a a a a b a a a a a . . .\n            e 6 6 e . a c b a a a a . a . .\n            e . a e . a a b a b b a . a . .\n            e 6 6 e . a c b a a a a . a . .\n            . e e . . a a b a a a a . a . .\n            . . . . . e e e e e e e . . . .\n            . . . . . c c c c c c c . . . .\n            . . . . . c . . . . . c . . . .\n            `)\n        story.printDialog(\"Oh, nice! Everyone is always so serious around here\", 80, 90, 50, 150)\n        story.printDialog(\"We could really use a ballad or two to lighten the mood\", 80, 90, 50, 150)\n    }\n})\n\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","sprite-cancel-movement.md":"# sprite cancel movement\n\nCancel the current movement operation on a [sprite](/types/sprite).\n\n```sig\nstory.cancelSpriteMovement(sprites.create(img`\n    .\n    `, SpriteKind.Player))\n```\n\n## Parameters\n\n* **sprite**: a [sprite](/types/sprite) to cancel the movement operation on\n\n## Example #example\n\nIn this example, we create a few objects and place them on the screen. Then we create a player, ask where they would like to move, and choose a destination based on that choice. Putting the cutscene code in a while loop makes it repeat forever. Pressing the B button cancels the current movement and causes the cutscene to advance.\n\n```blocks\ncontroller.B.onEvent(ControllerButtonEvent.Pressed, function () {\n    story.cancelSpriteMovement(sprite)\n})\nlet sprite: Sprite = null\nlet rock = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . b b b b b b b . . . .\n    . . . . b b b b b b b b b . . .\n    . . . b b b b b b b b b b . . .\n    . . . b b b b b b b b b b . . .\n    . . . b b b b b b b b b b b . .\n    . . c b b b b b b b b b b b . .\n    . . c b b b b b b b b b b b . .\n    . . c b b b b b b b b b b b . .\n    . . c c c c b b b b b b b b . .\n    . . . . . c c c c c c c c c . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    `, SpriteKind.Player)\nrock.setPosition(24, 21)\nlet shirt = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . b b b b b b b b . . . .\n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n    2 2 2 2 c 2 c 2 2 2 c 2 2 2 2 2\n    2 2 2 c c c c c 2 c c 2 2 2 2 2\n    . . 2 2 c 2 c 2 2 2 c 2 2 2 . .\n    . . 2 c c c c c 2 2 c 2 2 2 . .\n    . . 2 2 c 2 c 2 2 c c c 2 2 . .\n    . . 2 2 2 2 2 2 2 2 2 2 2 2 . .\n    . . c c 2 2 2 c 2 2 c c 2 2 . .\n    . . c 2 c 2 c 2 c 2 c 2 c 2 . .\n    . . c 2 c 2 c c c 2 c 2 c 2 . .\n    . . c c 2 2 c 2 c 2 c c 2 2 . .\n    . . 2 2 2 2 2 2 2 2 2 2 2 2 . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    `, SpriteKind.Player)\nshirt.setPosition(71, 98)\nlet duck = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . 5 5 5 . . . . . . . .\n    . . . . . 5 f 5 . . . . . . . .\n    . . . . 4 5 5 5 . . . . . . . .\n    . . . . . . . 5 . . . . . . . .\n    . . . . . . . 5 5 5 5 5 5 5 . .\n    . . . . . . . 5 5 5 5 5 5 . . .\n    . . . . . . . 5 5 5 5 5 5 . . .\n    . . . . . . . . 4 . 4 . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    `, SpriteKind.Player)\nduck.setPosition(132, 23)\nsprite = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . b b . . . . . . . . . . .\n    . . . b b b b b b b b b b . . .\n    . . . . 3 3 3 3 3 3 3 3 b . . .\n    . . . . 3 1 3 3 1 3 3 3 b . . .\n    . . . . 3 3 3 3 3 3 3 3 . . . .\n    . . . . 3 3 3 3 3 3 3 3 . . . .\n    . . . a a a c a a a a a a . . .\n    . . a . a b c a c c a a . a . .\n    . . a . a a c a a a a a . a . .\n    . . a . a b c a a a a a . a . .\n    . . 3 . a a c a a a a a . 3 . .\n    . . . . e e 4 e e e e e . . . .\n    . . . . c c c c c c c c . . . .\n    . . . . c c c c c c c c . . . .\n    . . . . c . . . . . . c . . . .\n    `, SpriteKind.Player)\nscene.setBackgroundColor(7)\nstory.startCutscene(function () {\n    while (true) {\n        story.spriteSayText(sprite, \"Hmm...\")\n        story.spriteSayText(sprite, \"Where should I walk?\")\n        story.showPlayerChoices(\"Rock\", \"T-Shirt\", \"Duck\")\n        if (story.checkLastAnswer(\"Rock\")) {\n            story.spriteMoveToLocation(sprite, rock.x, rock.y, 50)\n        } else if (story.checkLastAnswer(\"T-Shirt\")) {\n            story.spriteMoveToLocation(sprite, shirt.x, shirt.y, 50)\n        } else {\n            story.spriteMoveToLocation(sprite, duck.x, duck.y, 50)\n        }\n    }\n})\n\n```\n\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","sprite-move-to-position.md":"# sprite move to position\n\nMoves a [sprite](/types/sprite) directly to a specific x y position and pauses until the move is complete. If there are walls blocking the [sprite](/types/sprite), it will attempt to move and then teleport to its final destination.\n\nA [sprite](/types/sprite) can only have one movement operation active at a time, so calling this on a sprite that is already moving will cancel the other task.\n\n```sig\nstory.spriteMoveToLocation(sprites.create(img`\n    .\n    `, SpriteKind.Player), 0, 0, 100)\n```\n\n## Parameters\n\n* **sprite**: a [sprite](/types/sprite) to move to a position\n* **x**: a [number](/types/number) x position to move to\n* **y**: a [number](/types/number) y position to move to\n* **speed**: a [number](/types/number) representing how fast the [sprite](/types/sprite) should move to its destination\n\n## Example #example\n\nIn this example, we create a few objects and place them on the screen. Then we create a player, ask where they would like to move, and choose a destination based on that choice. Putting the cutscene code in a while loop makes it repeat forever.\n\n\n```blocks\nlet rock = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . b b b b b b b . . . .\n    . . . . b b b b b b b b b . . .\n    . . . b b b b b b b b b b . . .\n    . . . b b b b b b b b b b . . .\n    . . . b b b b b b b b b b b . .\n    . . c b b b b b b b b b b b . .\n    . . c b b b b b b b b b b b . .\n    . . c b b b b b b b b b b b . .\n    . . c c c c b b b b b b b b . .\n    . . . . . c c c c c c c c c . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    `, SpriteKind.Player)\nrock.setPosition(24, 21)\nlet shirt = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . b b b b b b b b . . . .\n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n    2 2 2 2 c 2 c 2 2 2 c 2 2 2 2 2\n    2 2 2 c c c c c 2 c c 2 2 2 2 2\n    . . 2 2 c 2 c 2 2 2 c 2 2 2 . .\n    . . 2 c c c c c 2 2 c 2 2 2 . .\n    . . 2 2 c 2 c 2 2 c c c 2 2 . .\n    . . 2 2 2 2 2 2 2 2 2 2 2 2 . .\n    . . c c 2 2 2 c 2 2 c c 2 2 . .\n    . . c 2 c 2 c 2 c 2 c 2 c 2 . .\n    . . c 2 c 2 c c c 2 c 2 c 2 . .\n    . . c c 2 2 c 2 c 2 c c 2 2 . .\n    . . 2 2 2 2 2 2 2 2 2 2 2 2 . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    `, SpriteKind.Player)\nshirt.setPosition(71, 98)\nlet duck = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . 5 5 5 . . . . . . . .\n    . . . . . 5 f 5 . . . . . . . .\n    . . . . 4 5 5 5 . . . . . . . .\n    . . . . . . . 5 . . . . . . . .\n    . . . . . . . 5 5 5 5 5 5 5 . .\n    . . . . . . . 5 5 5 5 5 5 . . .\n    . . . . . . . 5 5 5 5 5 5 . . .\n    . . . . . . . . 4 . 4 . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    `, SpriteKind.Player)\nduck.setPosition(132, 23)\nlet sprite = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . b b . . . . . . . . . . .\n    . . . b b b b b b b b b b . . .\n    . . . . 3 3 3 3 3 3 3 3 b . . .\n    . . . . 3 1 3 3 1 3 3 3 b . . .\n    . . . . 3 3 3 3 3 3 3 3 . . . .\n    . . . . 3 3 3 3 3 3 3 3 . . . .\n    . . . a a a c a a a a a a . . .\n    . . a . a b c a c c a a . a . .\n    . . a . a a c a a a a a . a . .\n    . . a . a b c a a a a a . a . .\n    . . 3 . a a c a a a a a . 3 . .\n    . . . . e e 4 e e e e e . . . .\n    . . . . c c c c c c c c . . . .\n    . . . . c c c c c c c c . . . .\n    . . . . c . . . . . . c . . . .\n    `, SpriteKind.Player)\nscene.setBackgroundColor(7)\nstory.startCutscene(function () {\n    while (true) {\n        story.spriteSayText(sprite, \"Hmm...\")\n        story.spriteSayText(sprite, \"Where should I walk?\")\n        story.showPlayerChoices(\"Rock\", \"T-Shirt\", \"Duck\")\n        if (story.checkLastAnswer(\"Rock\")) {\n            story.spriteMoveToLocation(sprite, rock.x, rock.y, 100)\n        } else if (story.checkLastAnswer(\"T-Shirt\")) {\n            story.spriteMoveToLocation(sprite, shirt.x, shirt.y, 100)\n        } else {\n            story.spriteMoveToLocation(sprite, duck.x, duck.y, 100)\n        }\n    }\n})\n\n```\n\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","sprite-move-to-tilemap-location.md":"# sprite move to tilemap location\n\nMoves a [sprite](/types/sprite) to a specified location in the tilemap using pathfinding and pauses until the movement is complete. If no path is possible, this block will cause an exception.\n\nA [sprite](/types/sprite) can only have one movement operation active at a time, so calling this on a [sprite](/types/sprite) that is already moving will cancel the other task.\n\n```sig\nstory.spriteMoveToTile(sprites.create(img`\n    .\n`, SpriteKind.Player), tiles.getTileLocation(0, 0), 100)\n```\n\n## Parameters\n\n* **sprite**: a [sprite](/types/sprite) to move to a tile\n* **location**: the [tile](/types/tile) location to move to\n* **speed**: a [number](/types/number) representing how fast the [sprite](/types/sprite) should move to its destination\n\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","sprite-say.md":"# sprite say\n\nPrints some text onto the screen over a [sprite](/types/sprite) one character at a time.\n\n```sig\nstory.spriteSayText(sprites.create(img`\n    .\n`, SpriteKind.Player), \"hello\", 15, 1, story.TextSpeed.VerySlow)\n```\n\n## Parameters\n\n* **text**: a [string](/types/string) that contains the text to print to the screen\n* **sprite**: a [sprite](/types/sprite) to display the text above.\n* **foreground**: an optional [number](/types/number) color for the text that is printed to the screen\n* **background**: an optional [number](/types/number) color for the rectangle that appears behind the text\n* **speed**: an optional speed that controls how fast the text is printed\n\n## Example #example\n\nCreate a plate sprite and a burger sprite and have the burger bounce around the screen. When the plate overlaps with the burger, have a sprite say some text asking if it's time to eat. When the overlap stops, say some disappointed text.\n\n\n```blocks\nnamespace SpriteKind {\n    export const Plate = SpriteKind.create()\n}\nsprites.onOverlap(SpriteKind.Plate, SpriteKind.Food, function (sprite, otherSprite) {\n    if (!(overlapping)) {\n        overlapping = true\n        story.startCutscene(function () {\n            story.spriteSayText(customer, \"Time to eat?\")\n        })\n    }\n})\nlet overlapping = false\nlet customer: Sprite = null\nlet plateSprite = sprites.create(img`\n    ...............bbbbbbbbbbbbbbbbbbb...............\n    ...........bbbbdd111111111111111ddbbbb...........\n    ........bbbd1111111111111111111111111dbbb........\n    ......bbd11111111dddddddddddddd111111111dbb......\n    ....bbd1111111ddd11111111111111dddd1111111dbb....\n    ...bd111111ddd111111111111111111111ddd111111db...\n    ..bd11111ddd111ddddddddddddddddddd111ddd11111db..\n    .bd11111dd111dddd111111111111111dddd111dd11111db.\n    .b11111d111ddd111111111111111111111ddd111d11111b.\n    bd11111d1ddd1111111111111111111111111ddd1111111db\n    b11111d1ddd111111111111111111111111111ddd1d11111b\n    b11111ddddd111111111111111111111111111ddddd11111b\n    b11111ddddd111111111111111111111111111dddbd11111b\n    b111111dddd111111111111111111111111111dddb111111b\n    bd111111dddd1111111111111111111111111dddbd11111db\n    .b1111111dddd11111111111111111111111dddbd111111b.\n    .bd1111111dbbdd1111111111111111111dddbbd111111db.\n    ..bd11111111dbbdd111111111111111dddbbd1111111db..\n    ...bd111111111dbbbbbbdddddddddddddd111111111db...\n    ....bbd11111111111dbbbbbbbbbddd11111111111dbb....\n    ......bbdd11111111111111111111111111111ddbb......\n    ........bbbdd11111111111111111111111ddbbb........\n    ...........bbbbbddd11111111111dddbbbbb...........\n    ................bbbbbbbbbbbbbbbbb................\n    `, SpriteKind.Plate)\nplateSprite.setPosition(115, 60)\nlet burger = sprites.create(img`\n    ...........ccccc66666...........\n    ........ccc4444444444666........\n    ......cc444444444bb4444466......\n    .....cb4444bb4444b5b444444b.....\n    ....eb4444b5b44444b44444444b....\n    ...ebb44444b4444444444b444446...\n    ..eb6bb444444444bb444b5b444446..\n    ..e6bb5b44444444b5b444b44bb44e..\n    .e66b4b4444444444b4444444b5b44e.\n    .e6bb444444444444444444444bb44e.\n    eb66b44444bb444444444444444444be\n    eb66bb444b5b44444444bb44444444be\n    fb666b444bb444444444b5b4444444bf\n    fcb666b44444444444444bb444444bcf\n    .fbb6666b44444444444444444444bf.\n    .efbb66666bb4444444444444444bfe.\n    .86fcbb66666bbb44444444444bcc688\n    8772effcbbbbbbbbbbbbbbbbcfc22778\n    87722222cccccccccccccccc22226678\n    f866622222222222222222222276686f\n    fef866677766667777776667777fffef\n    fbff877768f86777777666776fffffbf\n    fbeffeefffeff7766688effeeeefeb6f\n    f6bfffeffeeeeeeeeeeeeefeeeeebb6e\n    f66ddfffffeeeffeffeeeeeffeedb46e\n    .c66ddd4effffffeeeeeffff4ddb46e.\n    .fc6b4dddddddddddddddddddb444ee.\n    ..ff6bb444444444444444444444ee..\n    ....ffbbbb4444444444444444ee....\n    ......ffebbbbbb44444444eee......\n    .........fffffffcccccee.........\n    ................................\n    `, SpriteKind.Food)\nburger.setBounceOnWall(true)\nburger.setVelocity(15, 25)\ncustomer = sprites.create(img`\n    . . . . . f f 4 4 f f . . . . .\n    . . . . f 5 4 5 5 4 5 f . . . .\n    . . . f e 4 5 5 5 5 4 e f . . .\n    . . f b 3 e 4 4 4 4 e 3 b f . .\n    . . f 3 3 3 3 3 3 3 3 3 3 f . .\n    . f 3 3 e b 3 e e 3 b e 3 3 f .\n    . f 3 3 f f e e e e f f 3 3 f .\n    . f b b f b f e e f b f b b f .\n    . f b b e 1 f 4 4 f 1 e b b f .\n    f f b b f 4 4 4 4 4 4 f b b f f\n    f b b f f f e e e e f f f b b f\n    . f e e f b d d d d b f e e f .\n    . . e 4 c d d d d d d c 4 e . .\n    . . e f b d b d b d b b f e . .\n    . . . f f 1 d 1 d 1 d f f . . .\n    . . . . . f f b b f f . . . . .\n    `, SpriteKind.Player)\ncustomer.setPosition(45, 60)\ngame.onUpdate(function () {\n    if (overlapping && !(burger.overlapsWith(plateSprite))) {\n        overlapping = false\n        story.startCutscene(function () {\n            story.spriteSayText(customer, \"Awwwww...\")\n        })\n    }\n})\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","start-cutscene.md":"# start cutscene\n\nStarts a cutscene running in the background in which blocks from the story extension can be used.\nBlocks from the story extension pause before they finish, so they usually shouldn't be used in [on overlap tile](/reference/scene/on-overlap-tile), [on update](/reference/game/on-update), or [on update interval](/reference/game/on-update-interval) blocks unless they are wrapped in this block.\n\n```sig\nstory.startCutscene(function () {\n\n})\n```\n\n## Example #example\n\nIn this example, we create a player and an invisible event trigger. When the player overlaps the trigger, we destroy it and start a cutscene from within the overlap event.\n\n```blocks\nnamespace SpriteKind {\n    export const Duck = SpriteKind.create()\n    export const EventTrigger = SpriteKind.create()\n}\nsprites.onOverlap(SpriteKind.Player, SpriteKind.EventTrigger, function (sprite, otherSprite) {\n    otherSprite.destroy()\n    story.startCutscene(function () {\n        controller.moveSprite(thePlayer, 0, 0)\n        story.spriteMoveToLocation(thePlayer, thePlayer.x, 20, 100)\n        story.printDialog(\"One day as Samantha walked to school, she encountered a duck.\", 80, 90, 50, 150)\n        story.printDialog(\"This had certainly never happened before.\", 80, 90, 50, 150)\n        story.printDialog(\"As she locked eyes with the yellow bird, she realized the gravity of this event. Her life would never be the same again.\", 80, 90, 50, 150)\n        story.spriteMoveToLocation(duck, 180, 20, 100)\n        controller.moveSprite(thePlayer)\n    })\n})\nlet duck: Sprite = null\nlet thePlayer: Sprite = null\nscene.setBackgroundColor(13)\nthePlayer = sprites.create(img`\n    b b 2 b b b b b b b . . .\n    b b 2 b 3 3 3 3 3 3 . . .\n    b . . b 3 3 3 3 3 3 . . .\n    . . . b 3 3 1 3 3 1 . . .\n    . . . b 3 3 3 3 3 3 . . .\n    . . . b 3 3 3 3 3 3 . . .\n    . . . . 3 3 3 3 3 3 . . .\n    . . . a a a a a a a a . .\n    . . a . a a a a a a . a .\n    . . a . a a a a a a . a .\n    . . 3 . a a a a a a . 3 .\n    . . . . e e e e e e . . .\n    . . . . c c c c c c . . .\n    . . . . c . . . . c . . .\n    `, SpriteKind.Player)\nthePlayer.setStayInScreen(true)\ncontroller.moveSprite(thePlayer)\nthePlayer.setPosition(8, 53)\nlet event = sprites.create(img`\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    3333333333333333\n    `, SpriteKind.EventTrigger)\nevent.setFlag(SpriteFlag.Invisible, true)\nduck = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . 5 5 5 . . . . . . . .\n    . . . . . 5 f 5 . . . . . . . .\n    . . . . 4 5 5 5 . . . . . . . .\n    . . . . . . . 5 . . . . . . . .\n    . . . . . . . 5 5 5 5 5 5 5 . .\n    . . . . . . . 5 5 5 5 5 5 . . .\n    . . . . . . . 5 5 5 5 5 5 . . .\n    . . . . . . . . 4 . 4 . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    `, SpriteKind.Duck)\nduck.setPosition(135, 20)\n```\n\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","set-sound-enabled.md":"# set sound enabled\n\nSets whether or not the sound that plays as each character is printed is on.\n\n```sig\nstory.setSoundEnabled(true)\n```\n\n## Parameters\n\n* **enabled**: a [boolean](/types/boolean) indicating whether or not the sound should play\n\n\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","cancel-all-cutscenes.md":"# cancel all cutscenes\n\nCancels the current cutscene that is running within a [start cutscene]() block and all pending cutscenes. This will only cancel blocks from the \"Story\" category; other blocks like [ask for string](/reference/game/ask-for-string) will not be cancelled.\n\n```sig\nstory.cancelAllCutscenes()\n```\n\n## Example #example\n\nIn this example, we use [cancel all cutscenes]() to interrupt a conversation when the A button is pressed.\n\n```blocks\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    story.cancelAllCutscenes()\n    story.startCutscene(function () {\n        story.printCharacterText(\"OBJECTION!!!!\", \"Prosecutor\")\n        story.printCharacterText(\"That video is clearly using clips from the popular video \\\"CAT LUVS SUNBEAM LOL PLZ SUBSCRIBE\\\"\", \"Prosecutor\")\n    })\n})\nstory.startCutscene(function () {\n    story.printCharacterText(\"Your honor, I think you'll find that there is no way my client could have been present when the heist occurred\", \"Defense\")\n    story.printCharacterText(\"As you can see, the surveillance footage clearly indicates that my client was playing a charity tennis match against a cat at the time\", \"Defense\")\n})\nstory.startCutscene(function () {\n    story.printCharacterText(\"He lost three straight sets. Who would make up such a shameful display?\", \"Defense\")\n    story.printCharacterText(\"My client sits here, ashamed, knowing that the world now sees that a cat with no interest in the sport could beat them in a game of tennis\", \"Defense\")\n    story.printCharacterText(\"Who would allow themselves to be subjected to such humiliation? The cat was napping in a sunbeam for most of the second set\", \"Defense\")\n    story.printCharacterText(\"My client had nothing to do with this terrible crime\", \"Defense\")\n})\n\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```\n\n\n","get-last-answer.md":"# get last answer\n\nReturns the last answer [string](/types/string) chosen by the player in a menu created by [show player choices]().\n\n```sig\nstory.getLastAnswer()\n```\n\n## Example #example\n\nIn this example, we show how you could do a character selection scene at the beginning of a game.\nWe give the player three choices for a job, and then change the text and character image based on their choice.\n\n```blocks\nlet sprite = sprites.create(img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . b b b b b b b . . . .\n    . . . . . 3 3 3 3 3 3 b . . . .\n    . . . . . 1 3 3 3 1 3 b . . . .\n    . . . . . 3 3 3 3 3 3 3 . . . .\n    . . . . . 3 3 3 3 3 3 3 . . . .\n    . . . . a a a b a a a a a . . .\n    . . . a . a c b a a a a . a . .\n    . . . a . a a b a b b a . a . .\n    . . . a . a c b a a a a . a . .\n    . . . a . a a b a a a a . a . .\n    . . . . . e e e e e e e . . . .\n    . . . . . c c c c c c c . . . .\n    . . . . . c . . . . . c . . . .\n    `, SpriteKind.Player)\nsprite.setPosition(80, 40)\nscene.setBackgroundColor(13)\nstory.startCutscene(function () {\n    story.printDialog(\"Hey there!\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VeryFast)\n    story.printDialog(\"Welcome to your first day at the adventurer's guild!\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VeryFast)\n    story.printDialog(\"What job are you signing up for?\", 80, 90, 50, 150, 15, 1, story.TextSpeed.VeryFast)\n    story.showPlayerChoices(\"Warrior\", \"Wizard\", \"Bard\")\n    if (story.getLastAnswer() === \"Warrior\") {\n        sprite.setImage(img`\n            . . . . . . . . . . . . . . . .\n            . b . . . . . . . . . . . . . .\n            . b . . . . . . . . . . . . . .\n            . b . . . b b b b b b b . . . .\n            . b . . . 3 3 3 3 3 3 b . . . .\n            . b . . . 1 3 3 3 1 3 b . . . .\n            . b . . . 3 3 3 3 3 3 3 . . . .\n            6 6 6 . . 3 3 3 3 3 3 3 . . . .\n            . a a a a a a b a a a a a . . .\n            . 6 . . . a c b a a a a . a . .\n            . . . . . a a b a b b a . a . .\n            . . . . . a c b a a a 6 6 6 6 6\n            . . . . . a a b a a a 6 b b b 6\n            . . . . . e e e e e e 6 b b b 6\n            . . . . . c c c c c c c 6 b 6 .\n            . . . . . c . . . . . c . 6 . .\n            `)\n        story.printDialog(\"Ha, ha, ha, nice! More of the smashin' stuff type, are ya?\", 80, 90, 50, 150)\n        story.printDialog(\"We've got lots of that type around hered\", 80, 90, 50, 150)\n        story.printDialog(\"Make yourself at home!\", 80, 90, 50, 150)\n    } else if (story.getLastAnswer() === \"Wizard\") {\n        sprite.setImage(img`\n            . . . . . . . . 8 . . . . . . .\n            . . . . . . . 8 8 8 . . . . . .\n            . . . . . . 8 8 8 8 8 . . . . .\n            . . . . . . 8 8 8 8 8 . . . . .\n            . . . . . 8 8 8 8 8 8 8 . . . .\n            . . . . 8 8 8 8 8 8 8 8 8 . . .\n            . 2 . . . 3 3 3 3 3 3 b . . . .\n            . e . . . 1 3 3 3 1 3 b . . . .\n            . e . . . 3 3 3 3 3 3 3 . . . .\n            . e . . . 3 3 3 3 3 3 3 . . . .\n            . e 6 6 6 6 4 6 6 6 6 6 6 . . .\n            . e . . . 6 8 6 6 6 6 6 . 6 . .\n            . e . . . 6 8 6 6 6 6 6 . 6 . .\n            . e . . . 8 8 8 6 6 6 6 . 6 . .\n            . e . . . 8 8 8 6 6 6 6 . 6 . .\n            . e . . . 8 8 8 6 6 6 6 . . . .\n            . . . . . 8 8 8 6 6 6 6 . . . .\n            . . . . . 8 8 8 6 6 6 6 . . . .\n            `)\n        story.printDialog(\"WHOA THAT'S SO COOL!\", 80, 90, 50, 150)\n        story.printDialog(\"So you can do like spells and incantations and such?\", 80, 90, 50, 150)\n        story.printDialog(\"No foolin'!? Well I'm sure you'll have no trouble handling yourself here\", 80, 90, 50, 150)\n    } else if (story.getLastAnswer() === \"Bard\") {\n        sprite.setImage(img`\n            . . . . . . . . . . . . . . . .\n            . . . . . . . . . . . . . . f f\n            . . f f . . . . . . . . . . f .\n            . . f . . b b b b b b b . . f .\n            . . f . . 3 3 3 3 3 3 b . f f .\n            . f f . . 1 3 3 3 1 3 b . f f .\n            . f f . . 3 3 3 3 3 3 3 . . . .\n            . . . . . 3 3 3 3 3 3 3 . . . .\n            . . . a a a a b a a a a a . . .\n            e 6 6 e . a c b a a a a . a . .\n            e . a e . a a b a b b a . a . .\n            e 6 6 e . a c b a a a a . a . .\n            . e e . . a a b a a a a . a . .\n            . . . . . e e e e e e e . . . .\n            . . . . . c c c c c c c . . . .\n            . . . . . c . . . . . c . . . .\n            `)\n        story.printDialog(\"Oh, nice. Everyone is always so serious around here\", 80, 90, 50, 150)\n        story.printDialog(\"We could really use a ballad or two to lighten the mood\", 80, 90, 50, 150)\n    }\n})\n\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```\n\n\n","is-menu-open.md":"# is menu open\n\nChecks to see if the menu created by the [show player choices]() block is currently open\n\n```sig\nstory.isMenuOpen()\n```\n\n\n## Example #example\n\nIn this example we have a menu show up after 5 seconds to ask the user to upgrade their ship and\ndisable the button events we created using \"is menu open\".\n\n```blocks\ncontroller.up.onEvent(ControllerButtonEvent.Pressed, function () {\n    if (!(story.isMenuOpen())) {\n        projectile = sprites.createProjectileFromSprite(img`\n            3 3\n            3 3\n            3 3\n            3 3\n            `, sprite, 0, -100)\n    }\n})\ninfo.onCountdownEnd(function () {\n    story.startCutscene(function () {\n        story.printText(\"Upgrade ship?\", 80, 60)\n        controller.moveSprite(sprite, 0, 0)\n        story.showPlayerChoices(\"New Blaster\", \"New Thrusters\", \"No Thanks\")\n        controller.moveSprite(sprite, 100, 0)\n    })\n})\nlet projectile: Sprite = null\nlet sprite: Sprite = null\nsprite = sprites.create(img`\n    . . . . . . . c d . . . . . . .\n    . . . . . . . c d . . . . . . .\n    . . . . . . . c d . . . . . . .\n    . . . . . . . c b . . . . . . .\n    . . . . . . . f f . . . . . . .\n    . . . . . . . c 4 . . . . . . .\n    . . . . . . . f f . . . . . . .\n    . . . . . . . e 4 . . . . . . .\n    . . . . . . e e 5 2 . . . . . .\n    . . . . . . e 4 5 2 . . . . . .\n    . . . . . c c c 2 2 2 . . . . .\n    . . . . e e 4 4 4 5 2 2 . . . .\n    . . e f f f c c 2 2 f f 2 2 . .\n    . e e e e 2 2 4 4 4 4 5 4 2 2 .\n    e e e e e e 2 2 4 4 4 5 4 4 2 2\n    e e e e e e 2 2 4 4 4 4 5 4 2 2\n    `, SpriteKind.Player)\ncontroller.moveSprite(sprite, 100, 0)\nsprite.bottom = 120\ninfo.startCountdown(5)\n```\n\n```package\narcade-story=github:microsoft/arcade-storytelling\n```","test.ts":"// story.printDialog(\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\", 80, 60, 1, 15, story.TextSpeed.Fast) \r\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, () => {\r\n    story.clearQueuedStoryParts();\r\n    game.splash(\"CLEARED!\");\r\n})\r\n\r\nstory.queueStoryPart(() => {\r\n    story.printDialog(\"Here is some test text. it's got some punctuation, and i wouldn't love if it didn't break like i expected it too.\", 80, 90, 50, 150, 0xF, 0x1, story.TextSpeed.VeryFast);\r\n});\r\nstory.queueStoryPart(() => {\r\n    story.printDialog(\"Here is some more text; if you pressed A to clear before this started and it's still showing up, something is wrong :(\", 80, 90, 50, 150);\r\n});\r\n"}}